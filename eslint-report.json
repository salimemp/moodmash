[
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\__tests__\\api\\dashboard-stats.test.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 150,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 150,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [4450, 4453], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [4450, 4453], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { createMocks } from 'node-mocks-http';\r\nimport type { NextApiRequest, NextApiResponse } from 'next';\r\nimport dashboardStatsHandler from '@/pages/api/dashboard/stats';\r\nimport { getSessionFromReq } from '@/lib/auth/utils';\r\nimport { db } from '@/lib/db/prisma';\r\n\r\n// Mock the dependencies\r\njest.mock('@/lib/auth/utils', () => ({\r\n  getSessionFromReq: jest.fn(),\r\n}));\r\n\r\njest.mock('@/lib/db/prisma', () => {\r\n  const mockDb = {\r\n    mood: {\r\n      count: jest.fn(),\r\n      findMany: jest.fn(),\r\n    },\r\n    moodLike: {\r\n      count: jest.fn(),\r\n    },\r\n    moodComment: {\r\n      count: jest.fn(),\r\n    },\r\n    $transaction: jest.fn(),\r\n  };\r\n  \r\n  return { db: mockDb };\r\n});\r\n\r\n// Sample user for tests\r\nconst mockUser = {\r\n  id: 'test-user-id',\r\n  name: 'Test User',\r\n  email: 'test@example.com',\r\n};\r\n\r\n// Sample session for tests\r\nconst mockSession = {\r\n  user: mockUser,\r\n  expires: '2099-01-01T00:00:00.000Z',\r\n};\r\n\r\n// Sample mood data for tests\r\nconst mockMoods = [\r\n  {\r\n    id: 'mood1',\r\n    emoji: 'ðŸ˜€',\r\n    text: 'Feeling good!',\r\n    gradientColors: ['#ff0000', '#00ff00'],\r\n    createdAt: new Date('2023-01-01'),\r\n    _count: {\r\n      moodLikes: 5,\r\n      moodComments: 2,\r\n    },\r\n  },\r\n  {\r\n    id: 'mood2',\r\n    emoji: 'ðŸ˜¢',\r\n    text: 'Feeling sad',\r\n    gradientColors: ['#0000ff', '#ff00ff'],\r\n    createdAt: new Date('2023-01-02'),\r\n    _count: {\r\n      moodLikes: 3,\r\n      moodComments: 1,\r\n    },\r\n  },\r\n];\r\n\r\ndescribe('/api/dashboard/stats', () => {\r\n  beforeEach(() => {\r\n    jest.resetAllMocks();\r\n    // Set up default session\r\n    (getSessionFromReq as jest.Mock).mockResolvedValue(mockSession);\r\n    \r\n    // Set up $transaction mock to return an array of results\r\n    (db.$transaction as jest.Mock).mockImplementation(async (queries) => {\r\n      // Execute each query function to get its mock result\r\n      const results = [];\r\n      for (const query of queries) {\r\n        const result = await query;\r\n        results.push(result);\r\n      }\r\n      return results;\r\n    });\r\n    \r\n    // Set up default mock return values\r\n    (db.mood.count as jest.Mock).mockResolvedValue(10);\r\n    (db.moodLike.count as jest.Mock).mockResolvedValue(25);\r\n    (db.moodComment.count as jest.Mock).mockResolvedValue(15);\r\n    (db.mood.findMany as jest.Mock).mockResolvedValue(mockMoods);\r\n  });\r\n\r\n  it('returns dashboard stats successfully', async () => {\r\n    // Mock the request\r\n    const { req, res } = createMocks<NextApiRequest, NextApiResponse>({\r\n      method: 'GET',\r\n    });\r\n\r\n    // Call the handler\r\n    await dashboardStatsHandler(req, res);\r\n\r\n    // Check response\r\n    expect(res._getStatusCode()).toBe(200);\r\n    const responseData = JSON.parse(res._getData());\r\n    \r\n    // Check for expected properties\r\n    expect(responseData).toHaveProperty('moodCount', 10);\r\n    expect(responseData).toHaveProperty('likesReceived', 25);\r\n    expect(responseData).toHaveProperty('commentsReceived', 15);\r\n    expect(responseData).toHaveProperty('recentActivity');\r\n    expect(responseData).toHaveProperty('lastUpdated');\r\n    \r\n    // Check that activity data is formatted correctly\r\n    expect(responseData.recentActivity).toHaveLength(2);\r\n    expect(responseData.recentActivity[0]).toHaveProperty('id', 'mood1');\r\n    expect(responseData.recentActivity[0]).toHaveProperty('emoji', 'ðŸ˜€');\r\n    expect(responseData.recentActivity[0]).toHaveProperty('likes', 5);\r\n    expect(responseData.recentActivity[0]).toHaveProperty('comments', 2);\r\n    \r\n    // Verify the transaction was called with the right queries\r\n    expect(db.$transaction).toHaveBeenCalled();\r\n    expect(db.mood.count).toHaveBeenCalledWith({\r\n      where: { userId: mockUser.id },\r\n    });\r\n  });\r\n\r\n  it('handles missing user authentication', async () => {\r\n    // Mock no session\r\n    (getSessionFromReq as jest.Mock).mockResolvedValue(null);\r\n    \r\n    // Mock the request\r\n    const { req, res } = createMocks<NextApiRequest, NextApiResponse>({\r\n      method: 'GET',\r\n    });\r\n\r\n    // Call the handler\r\n    await dashboardStatsHandler(req, res);\r\n\r\n    // Should return unauthorized\r\n    expect(res._getStatusCode()).toBe(401);\r\n    expect(JSON.parse(res._getData())).toHaveProperty('message');\r\n    \r\n    // DB queries should not be called\r\n    expect(db.$transaction).not.toHaveBeenCalled();\r\n  });\r\n\r\n  it('handles database errors', async () => {\r\n    // Mock a database error\r\n    const dbError = new Error('Database error');\r\n    (dbError as any).code = 'P2002'; // Simulate a Prisma error code\r\n    (db.$transaction as jest.Mock).mockRejectedValue(dbError);\r\n    \r\n    // Mock the request\r\n    const { req, res } = createMocks<NextApiRequest, NextApiResponse>({\r\n      method: 'GET',\r\n    });\r\n\r\n    // Call the handler\r\n    await dashboardStatsHandler(req, res);\r\n\r\n    // Should return server error with Prisma code\r\n    expect(res._getStatusCode()).toBe(500);\r\n    const errorResponse = JSON.parse(res._getData());\r\n    expect(errorResponse).toHaveProperty('message', 'Database error');\r\n    expect(errorResponse).toHaveProperty('code', 'P2002');\r\n  });\r\n\r\n  it('handles zero counts correctly', async () => {\r\n    // Mock empty counts and activity\r\n    (db.mood.count as jest.Mock).mockResolvedValue(0);\r\n    (db.moodLike.count as jest.Mock).mockResolvedValue(0);\r\n    (db.moodComment.count as jest.Mock).mockResolvedValue(0);\r\n    (db.mood.findMany as jest.Mock).mockResolvedValue([]);\r\n    \r\n    // Mock the request\r\n    const { req, res } = createMocks<NextApiRequest, NextApiResponse>({\r\n      method: 'GET',\r\n    });\r\n\r\n    // Call the handler\r\n    await dashboardStatsHandler(req, res);\r\n\r\n    // Check response\r\n    expect(res._getStatusCode()).toBe(200);\r\n    const responseData = JSON.parse(res._getData());\r\n    \r\n    // Check zero counts\r\n    expect(responseData).toHaveProperty('moodCount', 0);\r\n    expect(responseData).toHaveProperty('likesReceived', 0);\r\n    expect(responseData).toHaveProperty('commentsReceived', 0);\r\n    expect(responseData.recentActivity).toHaveLength(0);\r\n  });\r\n}); ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\__tests__\\api\\notifications.test.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\__tests__\\api\\preferences.test.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\app\\settings\\layout.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\app\\settings\\mfa\\page.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 80,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 80,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2340, 2343], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2340, 2343], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 126,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 126,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3602, 3605], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3602, 3605], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 167,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 167,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [4706, 4709], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [4706, 4709], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.",
        "line": 270,
        "column": 111,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&apos;" },
            "fix": {
              "range": [8735, 8949],
              "text": "\r\n                  Two-factor authentication adds an extra layer of security to your account. Once enabled, you&apos;ll need to provide a verification code from your authenticator app when signing in.\r\n                "
            },
            "desc": "Replace with `&apos;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&lsquo;" },
            "fix": {
              "range": [8735, 8949],
              "text": "\r\n                  Two-factor authentication adds an extra layer of security to your account. Once enabled, you&lsquo;ll need to provide a verification code from your authenticator app when signing in.\r\n                "
            },
            "desc": "Replace with `&lsquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#39;" },
            "fix": {
              "range": [8735, 8949],
              "text": "\r\n                  Two-factor authentication adds an extra layer of security to your account. Once enabled, you&#39;ll need to provide a verification code from your authenticator app when signing in.\r\n                "
            },
            "desc": "Replace with `&#39;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rsquo;" },
            "fix": {
              "range": [8735, 8949],
              "text": "\r\n                  Two-factor authentication adds an extra layer of security to your account. Once enabled, you&rsquo;ll need to provide a verification code from your authenticator app when signing in.\r\n                "
            },
            "desc": "Replace with `&rsquo;`."
          }
        ]
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.",
        "line": 307,
        "column": 31,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&apos;" },
            "fix": {
              "range": [10487, 10611],
              "text": "\r\n                    If you can&apos;t scan the QR code, enter this code manually in your authenticator app:\r\n                  "
            },
            "desc": "Replace with `&apos;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&lsquo;" },
            "fix": {
              "range": [10487, 10611],
              "text": "\r\n                    If you can&lsquo;t scan the QR code, enter this code manually in your authenticator app:\r\n                  "
            },
            "desc": "Replace with `&lsquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#39;" },
            "fix": {
              "range": [10487, 10611],
              "text": "\r\n                    If you can&#39;t scan the QR code, enter this code manually in your authenticator app:\r\n                  "
            },
            "desc": "Replace with `&#39;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rsquo;" },
            "fix": {
              "range": [10487, 10611],
              "text": "\r\n                    If you can&rsquo;t scan the QR code, enter this code manually in your authenticator app:\r\n                  "
            },
            "desc": "Replace with `&rsquo;`."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 5,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\nimport { useRouter } from 'next/navigation';\r\nimport Image from 'next/image';\r\nimport { Loader2, AlertCircle, CheckCircle, ShieldCheck, ShieldOff } from 'lucide-react';\r\n\r\n// Define the session user type with MFA properties\r\ninterface ExtendedUser {\r\n  id: string;\r\n  name?: string | null;\r\n  email?: string | null;\r\n  image?: string | null;\r\n  mfaEnabled?: boolean;\r\n}\r\n\r\ninterface ExtendedSession {\r\n  user?: ExtendedUser;\r\n  expires: string;\r\n}\r\n\r\nexport default function MFAPage() {\r\n  // Use optional chaining to handle the case when useSession is not available\r\n  const sessionData = useSession();\r\n  const session = sessionData?.data as ExtendedSession | null;\r\n  const status = sessionData?.status || 'unauthenticated';\r\n  \r\n  const router = useRouter();\r\n  \r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n  \r\n  const [mfaEnabled, setMfaEnabled] = useState(false);\r\n  const [setupData, setSetupData] = useState<{\r\n    secret: string;\r\n    qrCodeUrl: string;\r\n    backupCodes: string[];\r\n  } | null>(null);\r\n  \r\n  const [verificationCode, setVerificationCode] = useState('');\r\n  const [disableCode, setDisableCode] = useState('');\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  \r\n  // Check if MFA is already enabled\r\n  useEffect(() => {\r\n    if (status === 'loading') return;\r\n    \r\n    if (!session) {\r\n      router.push('/auth/signin');\r\n      return;\r\n    }\r\n    \r\n    // Check if user has MFA enabled\r\n    setMfaEnabled(session.user?.mfaEnabled || false);\r\n    setLoading(false);\r\n  }, [session, status, router]);\r\n  \r\n  // Start MFA setup\r\n  const handleSetupMFA = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      const response = await fetch('/api/auth/mfa/setup', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        const data = await response.json();\r\n        throw new Error(data.message || 'Failed to set up MFA');\r\n      }\r\n      \r\n      const data = await response.json();\r\n      setSetupData(data);\r\n    } catch (err: any) {\r\n      setError(err.message || 'An error occurred while setting up MFA');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  // Verify MFA code and enable MFA\r\n  const handleVerifyMFA = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    \r\n    if (!setupData) {\r\n      setError('MFA setup data is missing. Please restart the setup process.');\r\n      return;\r\n    }\r\n    \r\n    if (!verificationCode) {\r\n      setError('Please enter a verification code');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setIsSubmitting(true);\r\n      setError(null);\r\n      \r\n      const response = await fetch('/api/auth/mfa/verify', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          code: verificationCode,\r\n          secret: setupData.secret,\r\n        }),\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        const data = await response.json();\r\n        throw new Error(data.message || 'Failed to verify MFA code');\r\n      }\r\n      \r\n      setSuccess('MFA has been successfully enabled for your account');\r\n      setMfaEnabled(true);\r\n      \r\n      // Refresh session to update MFA status\r\n      router.refresh();\r\n    } catch (err: any) {\r\n      setError(err.message || 'An error occurred while verifying the MFA code');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n  \r\n  // Disable MFA\r\n  const handleDisableMFA = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    \r\n    if (!disableCode) {\r\n      setError('Please enter a verification code');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setIsSubmitting(true);\r\n      setError(null);\r\n      \r\n      const response = await fetch('/api/auth/mfa/disable', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          code: disableCode,\r\n        }),\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        const data = await response.json();\r\n        throw new Error(data.message || 'Failed to disable MFA');\r\n      }\r\n      \r\n      setSuccess('MFA has been successfully disabled for your account');\r\n      setMfaEnabled(false);\r\n      setSetupData(null);\r\n      \r\n      // Refresh session to update MFA status\r\n      router.refresh();\r\n    } catch (err: any) {\r\n      setError(err.message || 'An error occurred while disabling MFA');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n  \r\n  if (loading && status === 'loading') {\r\n    return (\r\n      <div className=\"flex justify-center items-center min-h-[60vh]\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <div className=\"container max-w-3xl py-8\">\r\n      <h1 className=\"text-3xl font-bold mb-6\">Two-Factor Authentication</h1>\r\n      \r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 text-red-700 p-4 rounded-md mb-6\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <AlertCircle className=\"h-4 w-4\" />\r\n            <h3 className=\"font-semibold\">Error</h3>\r\n          </div>\r\n          <p className=\"mt-1\">{error}</p>\r\n        </div>\r\n      )}\r\n      \r\n      {success && (\r\n        <div className=\"bg-green-50 border border-green-200 text-green-700 p-4 rounded-md mb-6\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <CheckCircle className=\"h-4 w-4\" />\r\n            <h3 className=\"font-semibold\">Success</h3>\r\n          </div>\r\n          <p className=\"mt-1\">{success}</p>\r\n        </div>\r\n      )}\r\n      \r\n      {mfaEnabled ? (\r\n        <div className=\"bg-white border rounded-lg shadow-sm\">\r\n          <div className=\"p-6 border-b\">\r\n            <h2 className=\"text-xl font-semibold flex items-center gap-2\">\r\n              <ShieldCheck className=\"h-5 w-5 text-green-600\" />\r\n              Two-Factor Authentication is Enabled\r\n            </h2>\r\n            <p className=\"text-gray-500 mt-1\">\r\n              Your account is protected with an additional layer of security.\r\n            </p>\r\n          </div>\r\n          <div className=\"p-6\">\r\n            <p className=\"mb-4\">\r\n              To disable two-factor authentication, enter a verification code from your authenticator app.\r\n            </p>\r\n            <form onSubmit={handleDisableMFA}>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"space-y-2\">\r\n                  <label htmlFor=\"disableCode\" className=\"block text-sm font-medium\">\r\n                    Verification Code\r\n                  </label>\r\n                  <input\r\n                    id=\"disableCode\"\r\n                    type=\"text\"\r\n                    className=\"w-full px-3 py-2 border rounded-md\"\r\n                    placeholder=\"Enter 6-digit code\"\r\n                    value={disableCode}\r\n                    onChange={(e) => setDisableCode(e.target.value)}\r\n                    maxLength={6}\r\n                  />\r\n                </div>\r\n                <button\r\n                  type=\"submit\"\r\n                  className=\"flex items-center justify-center w-full py-2 px-4 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50\"\r\n                  disabled={isSubmitting}\r\n                >\r\n                  {isSubmitting ? (\r\n                    <>\r\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                      Disabling...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <ShieldOff className=\"mr-2 h-4 w-4\" />\r\n                      Disable Two-Factor Authentication\r\n                    </>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <div className=\"bg-white border rounded-lg shadow-sm\">\r\n          <div className=\"p-6 border-b\">\r\n            <h2 className=\"text-xl font-semibold\">Set Up Two-Factor Authentication</h2>\r\n            <p className=\"text-gray-500 mt-1\">\r\n              Protect your account with an additional layer of security by requiring a verification code when you sign in.\r\n            </p>\r\n          </div>\r\n          <div className=\"p-6\">\r\n            {!setupData ? (\r\n              <div className=\"flex flex-col items-center gap-4\">\r\n                <p className=\"text-center mb-4\">\r\n                  Two-factor authentication adds an extra layer of security to your account. Once enabled, you'll need to provide a verification code from your authenticator app when signing in.\r\n                </p>\r\n                <button\r\n                  onClick={handleSetupMFA}\r\n                  disabled={loading}\r\n                  className=\"py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50\"\r\n                >\r\n                  {loading ? (\r\n                    <>\r\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                      Setting up...\r\n                    </>\r\n                  ) : (\r\n                    'Set Up Two-Factor Authentication'\r\n                  )}\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-6\">\r\n                <div className=\"space-y-2\">\r\n                  <h3 className=\"text-lg font-medium\">1. Scan QR Code</h3>\r\n                  <p className=\"text-sm text-gray-500\">\r\n                    Scan this QR code with your authenticator app (like Google Authenticator, Authy, or Microsoft Authenticator).\r\n                  </p>\r\n                  <div className=\"flex justify-center p-4 bg-white border rounded-lg\">\r\n                    <Image\r\n                      src={setupData.qrCodeUrl}\r\n                      alt=\"QR Code for MFA setup\"\r\n                      width={200}\r\n                      height={200}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"space-y-2\">\r\n                  <h3 className=\"text-lg font-medium\">2. Manual Setup</h3>\r\n                  <p className=\"text-sm text-gray-500\">\r\n                    If you can't scan the QR code, enter this code manually in your authenticator app:\r\n                  </p>\r\n                  <div className=\"p-3 bg-gray-100 rounded-md font-mono text-center break-all\">\r\n                    {setupData.secret}\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"space-y-2\">\r\n                  <h3 className=\"text-lg font-medium\">3. Verify Setup</h3>\r\n                  <p className=\"text-sm text-gray-500\">\r\n                    Enter the verification code from your authenticator app to complete the setup.\r\n                  </p>\r\n                  <form onSubmit={handleVerifyMFA}>\r\n                    <div className=\"space-y-4\">\r\n                      <div className=\"space-y-2\">\r\n                        <label htmlFor=\"verificationCode\" className=\"block text-sm font-medium\">\r\n                          Verification Code\r\n                        </label>\r\n                        <input\r\n                          id=\"verificationCode\"\r\n                          type=\"text\"\r\n                          className=\"w-full px-3 py-2 border rounded-md\"\r\n                          placeholder=\"Enter 6-digit code\"\r\n                          value={verificationCode}\r\n                          onChange={(e) => setVerificationCode(e.target.value)}\r\n                          maxLength={6}\r\n                        />\r\n                      </div>\r\n                      <button\r\n                        type=\"submit\"\r\n                        className=\"flex items-center justify-center w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50\"\r\n                        disabled={isSubmitting}\r\n                      >\r\n                        {isSubmitting ? (\r\n                          <>\r\n                            <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                            Verifying...\r\n                          </>\r\n                        ) : (\r\n                          'Verify and Enable'\r\n                        )}\r\n                      </button>\r\n                    </div>\r\n                  </form>\r\n                </div>\r\n                \r\n                <div className=\"space-y-2\">\r\n                  <h3 className=\"text-lg font-medium\">4. Save Backup Codes</h3>\r\n                  <p className=\"text-sm text-gray-500\">\r\n                    Save these backup codes in a secure place. You can use them to sign in if you lose access to your authenticator app.\r\n                  </p>\r\n                  <div className=\"p-3 bg-gray-100 rounded-md font-mono text-sm\">\r\n                    <div className=\"grid grid-cols-2 gap-2\">\r\n                      {setupData.backupCodes.map((code, index) => (\r\n                        <div key={index} className=\"p-1\">\r\n                          {code}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\EncryptionSettings.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'keyManager' is defined but never used.",
        "line": 3,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 3,
        "endColumn": 20
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'session' is assigned a value but never used.",
        "line": 22,
        "column": 17,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 22,
        "endColumn": 24
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.",
        "line": 122,
        "column": 26,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&apos;" },
            "fix": {
              "range": [4154, 4205],
              "text": "â€¢ You&apos;ll need to enter your password on new devices"
            },
            "desc": "Replace with `&apos;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&lsquo;" },
            "fix": {
              "range": [4154, 4205],
              "text": "â€¢ You&lsquo;ll need to enter your password on new devices"
            },
            "desc": "Replace with `&lsquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#39;" },
            "fix": {
              "range": [4154, 4205],
              "text": "â€¢ You&#39;ll need to enter your password on new devices"
            },
            "desc": "Replace with `&#39;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rsquo;" },
            "fix": {
              "range": [4154, 4205],
              "text": "â€¢ You&rsquo;ll need to enter your password on new devices"
            },
            "desc": "Replace with `&rsquo;`."
          }
        ]
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.",
        "line": 194,
        "column": 40,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&apos;" },
            "fix": {
              "range": [6747, 6940],
              "text": "\r\n              Your data is now protected with end-to-end encryption. To access your encrypted\r\n              data on a new device, you&apos;ll need to enter your encryption password.\r\n            "
            },
            "desc": "Replace with `&apos;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&lsquo;" },
            "fix": {
              "range": [6747, 6940],
              "text": "\r\n              Your data is now protected with end-to-end encryption. To access your encrypted\r\n              data on a new device, you&lsquo;ll need to enter your encryption password.\r\n            "
            },
            "desc": "Replace with `&lsquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#39;" },
            "fix": {
              "range": [6747, 6940],
              "text": "\r\n              Your data is now protected with end-to-end encryption. To access your encrypted\r\n              data on a new device, you&#39;ll need to enter your encryption password.\r\n            "
            },
            "desc": "Replace with `&#39;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rsquo;" },
            "fix": {
              "range": [6747, 6940],
              "text": "\r\n              Your data is now protected with end-to-end encryption. To access your encrypted\r\n              data on a new device, you&rsquo;ll need to enter your encryption password.\r\n            "
            },
            "desc": "Replace with `&rsquo;`."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 4,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { useState, useEffect } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\nimport { keyManager } from '@/lib/encryption/keyManager';\r\nimport { useEncryptedPreferences } from '@/lib/hooks/useEncryptedPreferences';\r\nimport { Button } from '@/components/ui/button/button';\r\nimport { \r\n  Card, \r\n  CardContent, \r\n  CardDescription, \r\n  CardFooter, \r\n  CardHeader, \r\n  CardTitle \r\n} from '@/components/ui/card/card';\r\nimport { Loader2, Lock, ShieldAlert, CheckCircle2, AlertTriangle } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\n\r\ninterface EncryptionSettingsProps {\r\n  onComplete?: () => void;\r\n}\r\n\r\nconst EncryptionSettings: React.FC<EncryptionSettingsProps> = ({ onComplete }) => {\r\n  const { data: session } = useSession();\r\n  const { isEncrypted, setupEncryption } = useEncryptedPreferences();\r\n  \r\n  const [setupStep, setSetupStep] = useState<'intro' | 'password' | 'confirm' | 'complete'>('intro');\r\n  const [password, setPassword] = useState('');\r\n  const [confirmPassword, setConfirmPassword] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  // Check if encryption is already set up\r\n  useEffect(() => {\r\n    if (isEncrypted) {\r\n      setSetupStep('complete');\r\n    }\r\n  }, [isEncrypted]);\r\n  \r\n  const handleNextStep = () => {\r\n    if (setupStep === 'intro') {\r\n      setSetupStep('password');\r\n    } else if (setupStep === 'password') {\r\n      if (!password || password.length < 8) {\r\n        setError('Password must be at least 8 characters long');\r\n        return;\r\n      }\r\n      setError(null);\r\n      setSetupStep('confirm');\r\n    } else if (setupStep === 'confirm') {\r\n      if (password !== confirmPassword) {\r\n        setError('Passwords do not match');\r\n        return;\r\n      }\r\n      handleSetupEncryption();\r\n    }\r\n  };\r\n  \r\n  const handlePrevStep = () => {\r\n    if (setupStep === 'confirm') {\r\n      setSetupStep('password');\r\n    } else if (setupStep === 'password') {\r\n      setSetupStep('intro');\r\n    }\r\n  };\r\n  \r\n  const handleSetupEncryption = async () => {\r\n    if (!password) return;\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      const success = await setupEncryption(password);\r\n      \r\n      if (success) {\r\n        setSetupStep('complete');\r\n        toast.success('End-to-end encryption set up successfully');\r\n        \r\n        if (onComplete) {\r\n          onComplete();\r\n        }\r\n      } else {\r\n        setError('Failed to set up encryption. Please try again.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error setting up encryption:', error);\r\n      setError('Failed to set up encryption');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  \r\n  return (\r\n    <Card className=\"max-w-md mx-auto\">\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2\">\r\n          <Lock className=\"h-5 w-5 text-primary\" />\r\n          End-to-End Encryption\r\n        </CardTitle>\r\n        <CardDescription>\r\n          {setupStep === 'complete' \r\n            ? 'Your data is protected with end-to-end encryption' \r\n            : 'Set up end-to-end encryption to protect your data'}\r\n        </CardDescription>\r\n      </CardHeader>\r\n      \r\n      <CardContent>\r\n        {setupStep === 'intro' && (\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              End-to-end encryption ensures that your sensitive data can only be read by you.\r\n              Even we cannot access your encrypted data.\r\n            </p>\r\n            \r\n            <div className=\"rounded-lg bg-amber-50 dark:bg-amber-950/30 p-3 border border-amber-200 dark:border-amber-800\">\r\n              <h4 className=\"font-medium flex items-center gap-2 text-amber-800 dark:text-amber-400\">\r\n                <AlertTriangle className=\"h-4 w-4\" />\r\n                Important\r\n              </h4>\r\n              <ul className=\"mt-2 text-sm space-y-1 text-amber-700 dark:text-amber-300\">\r\n                <li>â€¢ Your password is used to generate encryption keys</li>\r\n                <li>â€¢ We cannot recover your data if you forget your password</li>\r\n                <li>â€¢ You'll need to enter your password on new devices</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {setupStep === 'password' && (\r\n          <div className=\"space-y-4\">\r\n            <p className=\"text-sm\">\r\n              Create a strong password to protect your encryption keys.\r\n              This password will be used to encrypt and decrypt your data.\r\n            </p>\r\n            \r\n            <div>\r\n              <label htmlFor=\"password\" className=\"text-sm font-medium block mb-1\">\r\n                Encryption Password\r\n              </label>\r\n              <input\r\n                id=\"password\"\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                className=\"w-full p-2 border rounded\"\r\n                placeholder=\"Enter a strong password\"\r\n                autoComplete=\"new-password\"\r\n              />\r\n              {password && password.length < 8 && (\r\n                <p className=\"text-xs text-red-500 mt-1\">\r\n                  Password must be at least 8 characters\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {setupStep === 'confirm' && (\r\n          <div className=\"space-y-4\">\r\n            <p className=\"text-sm\">\r\n              Confirm your encryption password to proceed.\r\n            </p>\r\n            \r\n            <div>\r\n              <label htmlFor=\"confirm-password\" className=\"text-sm font-medium block mb-1\">\r\n                Confirm Password\r\n              </label>\r\n              <input\r\n                id=\"confirm-password\"\r\n                type=\"password\"\r\n                value={confirmPassword}\r\n                onChange={(e) => setConfirmPassword(e.target.value)}\r\n                className=\"w-full p-2 border rounded\"\r\n                placeholder=\"Confirm your password\"\r\n                autoComplete=\"new-password\"\r\n              />\r\n              {confirmPassword && password !== confirmPassword && (\r\n                <p className=\"text-xs text-red-500 mt-1\">\r\n                  Passwords do not match\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {setupStep === 'complete' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center gap-2 text-green-600\">\r\n              <CheckCircle2 className=\"h-5 w-5\" />\r\n              <span className=\"font-medium\">Encryption is active</span>\r\n            </div>\r\n            \r\n            <p className=\"text-sm\">\r\n              Your data is now protected with end-to-end encryption. To access your encrypted\r\n              data on a new device, you'll need to enter your encryption password.\r\n            </p>\r\n            \r\n            <div className=\"rounded-lg bg-blue-50 dark:bg-blue-950/30 p-3 border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-medium text-blue-800 dark:text-blue-400\">Encrypted Data</h4>\r\n              <ul className=\"mt-2 text-sm space-y-1 text-blue-700 dark:text-blue-300\">\r\n                <li>â€¢ User preferences</li>\r\n                <li>â€¢ Private messages</li>\r\n                <li>â€¢ Security settings</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {error && (\r\n          <div className=\"mt-4 p-3 bg-red-50 border border-red-200 rounded text-red-600 text-sm flex items-start gap-2\">\r\n            <ShieldAlert className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\r\n            <span>{error}</span>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n      \r\n      <CardFooter className=\"flex justify-between\">\r\n        {setupStep !== 'complete' && setupStep !== 'intro' && (\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            onClick={handlePrevStep}\r\n            disabled={isLoading}\r\n          >\r\n            Back\r\n          </Button>\r\n        )}\r\n        \r\n        {setupStep !== 'complete' ? (\r\n          <Button\r\n            type=\"button\"\r\n            onClick={handleNextStep}\r\n            disabled={isLoading || (setupStep === 'password' && (!password || password.length < 8))}\r\n            className={setupStep === 'intro' || setupStep === 'password' ? 'ml-auto' : ''}\r\n          >\r\n            {isLoading ? (\r\n              <>\r\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                Processing...\r\n              </>\r\n            ) : setupStep === 'confirm' ? (\r\n              'Set Up Encryption'\r\n            ) : (\r\n              'Next'\r\n            )}\r\n          </Button>\r\n        ) : (\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            onClick={onComplete}\r\n            className=\"ml-auto\"\r\n          >\r\n            Close\r\n          </Button>\r\n        )}\r\n      </CardFooter>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default EncryptionSettings; ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\ErrorBoundary.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\ErrorFallback.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\ErrorTest.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\LanguageSwitcher.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\Layout.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\SEO\\PageMeta.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 19,
        "column": 35,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 19,
        "endColumn": 38,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [438, 441], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [438, 441], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 19,
        "column": 63,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 19,
        "endColumn": 66,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [466, 469], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [466, 469], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 2,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import Head from 'next/head';\r\nimport { useRouter } from 'next/router';\r\n\r\ninterface PageMetaProps {\r\n  title?: string;\r\n  description?: string;\r\n  image?: string;\r\n  type?: 'website' | 'article' | 'profile';\r\n  canonical?: string;\r\n  noIndex?: boolean;\r\n  noFollow?: boolean;\r\n  publishedAt?: string;\r\n  updatedAt?: string;\r\n  tags?: string[];\r\n  author?: {\r\n    name: string;\r\n    url?: string;\r\n  };\r\n  structuredData?: Record<string, any> | Array<Record<string, any>>;\r\n}\r\n\r\nconst SITE_NAME = 'MoodMash';\r\nconst DEFAULT_DESCRIPTION = 'Express, track, and share your moods with the MoodMash app.';\r\nconst DEFAULT_IMAGE = '/images/og-default.jpg';\r\nconst BASE_URL = process.env.NEXT_PUBLIC_BASE_URL || 'https://moodmash.com';\r\n\r\n/**\r\n * PageMeta component for handling SEO metadata and structured data\r\n */\r\nexport function PageMeta({\r\n  title,\r\n  description = DEFAULT_DESCRIPTION,\r\n  image = DEFAULT_IMAGE,\r\n  type = 'website',\r\n  canonical,\r\n  noIndex = false,\r\n  noFollow = false,\r\n  publishedAt,\r\n  updatedAt,\r\n  tags,\r\n  author,\r\n  structuredData,\r\n}: PageMetaProps) {\r\n  const router = useRouter();\r\n  \r\n  // Format the full page title\r\n  const pageTitle = title ? `${title} | ${SITE_NAME}` : SITE_NAME;\r\n  \r\n  // Build the canonical URL\r\n  const canonicalUrl = canonical || `${BASE_URL}${router.asPath}`;\r\n  \r\n  // Build robots meta content\r\n  const robotsContent = `${noIndex ? 'noindex' : 'index'},${noFollow ? 'nofollow' : 'follow'}`;\r\n  \r\n  // Ensure image is an absolute URL\r\n  const ogImage = image.startsWith('http') ? image : `${BASE_URL}${image}`;\r\n  \r\n  return (\r\n    <Head>\r\n      {/* Basic Metadata */}\r\n      <title>{pageTitle}</title>\r\n      <meta name=\"description\" content={description} />\r\n      <link rel=\"canonical\" href={canonicalUrl} />\r\n      <meta name=\"robots\" content={robotsContent} />\r\n      \r\n      {/* Open Graph / Facebook */}\r\n      <meta property=\"og:type\" content={type} />\r\n      <meta property=\"og:url\" content={canonicalUrl} />\r\n      <meta property=\"og:title\" content={pageTitle} />\r\n      <meta property=\"og:description\" content={description} />\r\n      <meta property=\"og:image\" content={ogImage} />\r\n      <meta property=\"og:site_name\" content={SITE_NAME} />\r\n      \r\n      {/* Twitter */}\r\n      <meta name=\"twitter:card\" content=\"summary_large_image\" />\r\n      <meta name=\"twitter:url\" content={canonicalUrl} />\r\n      <meta name=\"twitter:title\" content={pageTitle} />\r\n      <meta name=\"twitter:description\" content={description} />\r\n      <meta name=\"twitter:image\" content={ogImage} />\r\n      \r\n      {/* Article Specific Metadata */}\r\n      {type === 'article' && publishedAt && (\r\n        <meta property=\"article:published_time\" content={publishedAt} />\r\n      )}\r\n      {type === 'article' && updatedAt && (\r\n        <meta property=\"article:modified_time\" content={updatedAt} />\r\n      )}\r\n      {type === 'article' && author && (\r\n        <meta property=\"article:author\" content={author.name} />\r\n      )}\r\n      {type === 'article' && tags && tags.length > 0 && (\r\n        <>\r\n          {tags.map((tag) => (\r\n            <meta key={tag} property=\"article:tag\" content={tag} />\r\n          ))}\r\n        </>\r\n      )}\r\n      \r\n      {/* JSON-LD Structured Data */}\r\n      {structuredData && (\r\n        <script\r\n          type=\"application/ld+json\"\r\n          dangerouslySetInnerHTML={{\r\n            __html: JSON.stringify(structuredData),\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Default website structured data if none provided */}\r\n      {!structuredData && (\r\n        <script\r\n          type=\"application/ld+json\"\r\n          dangerouslySetInnerHTML={{\r\n            __html: JSON.stringify({\r\n              '@context': 'https://schema.org',\r\n              '@type': 'WebSite',\r\n              name: SITE_NAME,\r\n              url: BASE_URL,\r\n              description: DEFAULT_DESCRIPTION,\r\n              potentialAction: {\r\n                '@type': 'SearchAction',\r\n                target: `${BASE_URL}/search?q={search_term_string}`,\r\n                'query-input': 'required name=search_term_string',\r\n              },\r\n            }),\r\n          }}\r\n        />\r\n      )}\r\n    </Head>\r\n  );\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\SecureMessaging.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 159,
        "column": 50,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 159,
        "endColumn": 53,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [5026, 5029], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [5026, 5029], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { useState, useEffect, useCallback } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\nimport { keyManager } from '@/lib/encryption/keyManager';\r\nimport { \r\n  createEncryptedMessage, \r\n  decryptMessage,\r\n  EncryptedMessage\r\n} from '@/lib/encryption/crypto';\r\nimport { api } from '@/lib/api/client';\r\nimport { Button } from '@/components/ui/button/button';\r\nimport { Loader2, Send, Lock, AlertCircle, User } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\n\r\ninterface SecureMessagingProps {\r\n  recipientId: string;\r\n  recipientName?: string;\r\n  onMessageSent?: () => void;\r\n}\r\n\r\ninterface MessageDisplay {\r\n  id: string;\r\n  content: string | null;\r\n  sender: string;\r\n  senderName?: string | null;\r\n  timestamp: Date;\r\n  isOutgoing: boolean;\r\n  isEncrypted: boolean;\r\n  isFailed?: boolean;\r\n}\r\n\r\ninterface ExtendedEncryptedMessage extends EncryptedMessage {\r\n  id?: string; // Optional ID from database\r\n  senderProfile?: {\r\n    name?: string | null;\r\n    image?: string | null;\r\n  };\r\n}\r\n\r\nconst SecureMessaging: React.FC<SecureMessagingProps> = ({ \r\n  recipientId, \r\n  recipientName = 'Recipient',\r\n  onMessageSent \r\n}) => {\r\n  const { data: session } = useSession();\r\n  const [messages, setMessages] = useState<MessageDisplay[]>([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSending, setIsSending] = useState(false);\r\n  const [recipientPublicKey, setRecipientPublicKey] = useState<string | null>(null);\r\n  const [encryptionReady, setEncryptionReady] = useState(false);\r\n  const [needsPassword, setNeedsPassword] = useState(false);\r\n  const [password, setPassword] = useState('');\r\n  \r\n  // Fetch recipient's public key\r\n  const fetchRecipientKey = useCallback(async () => {\r\n    try {\r\n      const response = await api.get<{ publicKey: string }>(`/users/${recipientId}/public-key`);\r\n      if (response.publicKey) {\r\n        setRecipientPublicKey(response.publicKey);\r\n        \r\n        // Store it locally for future use\r\n        keyManager?.storePublicKeyForUser(recipientId, response.publicKey);\r\n        return response.publicKey;\r\n      }\r\n      return null;\r\n    } catch (error) {\r\n      console.error('Failed to fetch recipient public key:', error);\r\n      toast.error('Could not fetch encryption key for recipient');\r\n      return null;\r\n    }\r\n  }, [recipientId]);\r\n  \r\n  // Check encryption readiness\r\n  const checkEncryptionStatus = useCallback(async () => {\r\n    if (!session?.user?.id) return false;\r\n    \r\n    // Initialize key manager if needed\r\n    keyManager?.initialize(session.user.id as string);\r\n    \r\n    // Check if we have keys\r\n    if (!keyManager?.hasKeys()) {\r\n      setNeedsPassword(true);\r\n      setEncryptionReady(false);\r\n      return false;\r\n    }\r\n    \r\n    // Check if we have encryption key in memory or session storage\r\n    if (!keyManager.getEncryptionKey()) {\r\n      setNeedsPassword(true);\r\n      setEncryptionReady(false);\r\n      return false;\r\n    }\r\n    \r\n    // Check if we have recipient's public key\r\n    let pubKey = keyManager.getPublicKeyForUser(recipientId);\r\n    if (!pubKey) {\r\n      // Try to fetch it\r\n      pubKey = await fetchRecipientKey();\r\n      if (!pubKey) {\r\n        toast.error('Encryption not available', {\r\n          description: 'Recipient has not set up encryption'\r\n        });\r\n        return false;\r\n      }\r\n    }\r\n    \r\n    setRecipientPublicKey(pubKey);\r\n    setEncryptionReady(true);\r\n    setNeedsPassword(false);\r\n    return true;\r\n  }, [session, recipientId, fetchRecipientKey]);\r\n  \r\n  // Decrypt incoming messages\r\n  const decryptMessages = useCallback((encryptedMessages: ExtendedEncryptedMessage[]) => {\r\n    if (!keyManager?.hasKeys() || !keyManager.getSecretKey()) {\r\n      return encryptedMessages.map(msg => ({\r\n        id: msg.id || `temp-${Date.now()}`,\r\n        content: null, // Can't decrypt without keys\r\n        sender: msg.sender,\r\n        timestamp: new Date(msg.timestamp),\r\n        isOutgoing: msg.sender === session?.user?.id,\r\n        isEncrypted: true,\r\n        isFailed: false\r\n      }));\r\n    }\r\n    \r\n    const secretKey = keyManager.getSecretKey()!;\r\n    \r\n    return encryptedMessages.map(msg => {\r\n      let decrypted = null;\r\n      let failed = false;\r\n      \r\n      try {\r\n        decrypted = decryptMessage(msg, secretKey);\r\n      } catch (error) {\r\n        console.error('Failed to decrypt message:', error);\r\n        failed = true;\r\n      }\r\n      \r\n      return {\r\n        id: msg.id || `temp-${Date.now()}`,\r\n        content: decrypted,\r\n        sender: msg.sender,\r\n        senderName: msg.senderProfile?.name,\r\n        timestamp: new Date(msg.timestamp),\r\n        isOutgoing: msg.sender === session?.user?.id,\r\n        isEncrypted: true,\r\n        isFailed: failed\r\n      };\r\n    });\r\n  }, [session]);\r\n  \r\n  // Fetch messages\r\n  const fetchMessages = useCallback(async () => {\r\n    if (!session?.user?.id) return;\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      const response = await api.get<{ messages: any[] }>('/api/messages/secure', {\r\n        cache: 'no-store'\r\n      });\r\n      \r\n      // Filter messages to/from current recipient\r\n      const relevantMessages = response.messages.filter(\r\n        msg => msg.sender === recipientId || msg.recipient === recipientId\r\n      );\r\n      \r\n      // Decrypt and format messages\r\n      const displayMessages = decryptMessages(relevantMessages);\r\n      setMessages(displayMessages);\r\n    } catch (error) {\r\n      console.error('Failed to fetch messages:', error);\r\n      toast.error('Failed to load messages');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [session, recipientId, decryptMessages]);\r\n  \r\n  // Initialize encryption and fetch messages\r\n  useEffect(() => {\r\n    if (session?.user?.id) {\r\n      checkEncryptionStatus().then(ready => {\r\n        if (ready) {\r\n          fetchMessages();\r\n        }\r\n      });\r\n    }\r\n  }, [session, checkEncryptionStatus, fetchMessages]);\r\n  \r\n  // Handle password submission for key derivation\r\n  const handlePasswordSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!password || !session?.user?.id) return;\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      \r\n      // Set encryption key from password\r\n      await keyManager?.setEncryptionKeyFromPassword(password);\r\n      \r\n      // Check encryption status again\r\n      const ready = await checkEncryptionStatus();\r\n      if (ready) {\r\n        fetchMessages();\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to derive key from password:', error);\r\n      toast.error('Failed to set up encryption with password');\r\n    } finally {\r\n      setIsLoading(false);\r\n      setPassword('');\r\n    }\r\n  };\r\n  \r\n  // Send encrypted message\r\n  const sendMessage = async () => {\r\n    if (!newMessage.trim() || !recipientPublicKey || !session?.user?.id) return;\r\n    \r\n    try {\r\n      setIsSending(true);\r\n      \r\n      // Get sender keys\r\n      const keys = keyManager?.getKeys();\r\n      if (!keys || !keys.secretKey || !keys.publicKey) {\r\n        throw new Error('Encryption keys not available');\r\n      }\r\n      \r\n      // Create encrypted message\r\n      const encMsg = createEncryptedMessage(\r\n        newMessage,\r\n        keys,\r\n        recipientPublicKey,\r\n        session.user.id as string,\r\n        recipientId,\r\n        { type: 'text' }\r\n      );\r\n      \r\n      // Add optimistic message to UI\r\n      const optimisticMsg: MessageDisplay = {\r\n        id: `temp-${Date.now()}`,\r\n        content: newMessage,\r\n        sender: session.user.id as string,\r\n        timestamp: new Date(),\r\n        isOutgoing: true,\r\n        isEncrypted: true\r\n      };\r\n      \r\n      setMessages(prev => [optimisticMsg, ...prev]);\r\n      setNewMessage('');\r\n      \r\n      // Send to server\r\n      await api.post('/api/messages/secure', {\r\n        recipient: recipientId,\r\n        encryptedMessage: encMsg\r\n      });\r\n      \r\n      // Notify parent component\r\n      if (onMessageSent) onMessageSent();\r\n      \r\n    } catch (error) {\r\n      console.error('Failed to send encrypted message:', error);\r\n      toast.error('Failed to send encrypted message');\r\n      \r\n      // Update the optimistic message to show failure\r\n      setMessages(prevMsgs => \r\n        prevMsgs.map(msg => \r\n          msg.id.startsWith('temp-') \r\n            ? { ...msg, isFailed: true } \r\n            : msg\r\n        )\r\n      );\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  };\r\n  \r\n  // Render password form if needed\r\n  if (needsPassword) {\r\n    return (\r\n      <div className=\"p-4 border rounded-lg\">\r\n        <div className=\"mb-4 flex items-center text-amber-600 gap-2\">\r\n          <Lock className=\"h-5 w-5\" />\r\n          <h3 className=\"font-semibold\">Encryption Setup Required</h3>\r\n        </div>\r\n        \r\n        <p className=\"text-sm mb-4\">\r\n          Please enter your password to enable end-to-end encrypted messaging.\r\n        </p>\r\n        \r\n        <form onSubmit={handlePasswordSubmit} className=\"space-y-4\">\r\n          <div>\r\n            <label htmlFor=\"password\" className=\"text-sm font-medium block mb-1\">\r\n              Password\r\n            </label>\r\n            <input\r\n              id=\"password\"\r\n              type=\"password\"\r\n              value={password}\r\n              onChange={e => setPassword(e.target.value)}\r\n              className=\"w-full p-2 border rounded\"\r\n              required\r\n            />\r\n          </div>\r\n          \r\n          <Button type=\"submit\" disabled={isLoading} className=\"w-full\">\r\n            {isLoading ? (\r\n              <>\r\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                Processing...\r\n              </>\r\n            ) : (\r\n              <>Unlock Encryption</>\r\n            )}\r\n          </Button>\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <div className=\"flex flex-col h-[500px] border rounded-lg overflow-hidden\">\r\n      {/* Header */}\r\n      <div className=\"p-3 border-b bg-gray-50 dark:bg-gray-800 flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <User className=\"h-5 w-5 text-gray-500\" />\r\n          <span className=\"font-medium\">{recipientName}</span>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center text-sm text-green-600 gap-1\">\r\n          <Lock className=\"h-4 w-4\" />\r\n          <span>End-to-End Encrypted</span>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Messages */}\r\n      <div className=\"flex-1 p-4 overflow-y-auto flex flex-col-reverse\">\r\n        {isLoading ? (\r\n          <div className=\"flex justify-center items-center h-full\">\r\n            <Loader2 className=\"h-8 w-8 animate-spin text-gray-400\" />\r\n          </div>\r\n        ) : messages.length > 0 ? (\r\n          messages.map(message => (\r\n            <div \r\n              key={message.id}\r\n              className={`mb-3 max-w-[80%] ${message.isOutgoing ? 'ml-auto' : 'mr-auto'}`}\r\n            >\r\n              <div \r\n                className={`p-3 rounded-lg ${\r\n                  message.isOutgoing \r\n                    ? 'bg-blue-600 text-white' \r\n                    : 'bg-gray-200 dark:bg-gray-700'\r\n                }`}\r\n              >\r\n                {message.content ? (\r\n                  <p>{message.content}</p>\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2 text-amber-500\">\r\n                    <AlertCircle className=\"h-4 w-4\" />\r\n                    <span className=\"text-sm\">\r\n                      {message.isFailed ? 'Failed to decrypt message' : 'Encrypted message'}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <div className={`text-xs mt-1 flex gap-2 ${message.isOutgoing ? 'text-right' : 'text-left'}`}>\r\n                <time>{message.timestamp.toLocaleTimeString()}</time>\r\n                {message.isEncrypted && (\r\n                  <Lock className=\"h-3 w-3 text-green-600\" />\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <div className=\"text-center text-gray-500 mt-8\">\r\n            <Lock className=\"h-8 w-8 mx-auto mb-2 text-gray-400\" />\r\n            <p>No messages yet. Start a secure conversation!</p>\r\n            <p className=\"text-sm mt-1\">\r\n              Messages are encrypted end-to-end and can only be read by you and {recipientName}.\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {/* Composer */}\r\n      <div className=\"p-3 border-t\">\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            type=\"text\"\r\n            value={newMessage}\r\n            onChange={e => setNewMessage(e.target.value)}\r\n            placeholder=\"Type a secure message...\"\r\n            className=\"flex-1 p-2 border rounded-lg\"\r\n            disabled={!encryptionReady || isSending}\r\n          />\r\n          \r\n          <Button \r\n            onClick={sendMessage} \r\n            disabled={!newMessage.trim() || !encryptionReady || isSending}\r\n          >\r\n            {isSending ? (\r\n              <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n            ) : (\r\n              <Send className=\"h-4 w-4\" />\r\n            )}\r\n          </Button>\r\n        </div>\r\n        \r\n        {!encryptionReady && !needsPassword && (\r\n          <div className=\"text-xs text-amber-600 mt-2 flex items-center gap-1\">\r\n            <AlertCircle className=\"h-3 w-3\" />\r\n            <span>\r\n              Cannot send encrypted messages. {recipientName} has not set up encryption.\r\n            </span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SecureMessaging; ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\auth\\WebAuthnLogin.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\auth\\WebAuthnRegister.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\layout\\main-layout.tsx",
    "messages": [
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 79,
        "column": 25,
        "nodeType": "JSXOpeningElement",
        "endLine": 83,
        "endColumn": 27
      },
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 189,
        "column": 25,
        "nodeType": "JSXOpeningElement",
        "endLine": 193,
        "endColumn": 27
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 2,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\r\n\r\nimport { ReactNode, useState } from 'react';\r\nimport { useTheme } from '@/lib/providers/theme-provider';\r\nimport { Button } from '@/components/ui/button/button';\r\nimport { MoonIcon, SunIcon, UserIcon, LogOutIcon, LogInIcon, MenuIcon } from 'lucide-react';\r\nimport Link from 'next/link';\r\nimport { useSession, signOut } from 'next-auth/react';\r\nimport { \r\n  Dialog, \r\n  DialogContent, \r\n  DialogTrigger \r\n} from '@/components/ui/modal/dialog';\r\n\r\ninterface MainLayoutProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function MainLayout({ children }: MainLayoutProps) {\r\n  const { theme, setTheme } = useTheme();\r\n  const session = useSession()?.data;\r\n  const status = useSession()?.status || 'unauthenticated';\r\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\r\n\r\n  const toggleTheme = () => {\r\n    setTheme(theme === 'dark' ? 'light' : 'dark');\r\n  };\r\n\r\n  const handleSignOut = () => {\r\n    signOut({ callbackUrl: '/' });\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <header className=\"sticky top-0 z-50 border-b bg-background\">\r\n        <div className=\"container flex h-16 items-center justify-between\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Link href=\"/\" className=\"text-xl font-bold\">MoodMash</Link>\r\n          </div>\r\n          \r\n          {/* Desktop Navigation */}\r\n          <div className=\"hidden md:flex items-center gap-6\">\r\n            <nav className=\"flex items-center gap-6\">\r\n              <Link href=\"/\" className=\"text-sm font-medium hover:text-primary\">\r\n                Home\r\n              </Link>\r\n              <Link href=\"/explore\" className=\"text-sm font-medium hover:text-primary\">\r\n                Explore\r\n              </Link>\r\n              {session && (\r\n                <>\r\n                  <Link href=\"/dashboard\" className=\"text-sm font-medium hover:text-primary\">\r\n                    Dashboard\r\n                  </Link>\r\n                  <Link href=\"/profile\" className=\"text-sm font-medium hover:text-primary\">\r\n                    Profile\r\n                  </Link>\r\n                </>\r\n              )}\r\n            </nav>\r\n            \r\n            <div className=\"flex items-center gap-4\">\r\n              <Button \r\n                variant=\"ghost\" \r\n                size=\"icon\" \r\n                onClick={toggleTheme}\r\n                aria-label=\"Toggle theme\"\r\n              >\r\n                {theme === 'dark' ? <SunIcon className=\"h-5 w-5\" /> : <MoonIcon className=\"h-5 w-5\" />}\r\n              </Button>\r\n              \r\n              {status === 'loading' ? (\r\n                <div className=\"h-9 w-9 rounded-full bg-muted animate-pulse\"></div>\r\n              ) : session ? (\r\n                <Dialog>\r\n                  <DialogTrigger asChild>\r\n                    <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full\">\r\n                      {session.user?.image ? (\r\n                        <img \r\n                          src={session.user.image} \r\n                          alt={session.user.name || 'User'} \r\n                          className=\"h-8 w-8 rounded-full\"\r\n                        />\r\n                      ) : (\r\n                        <UserIcon className=\"h-5 w-5\" />\r\n                      )}\r\n                    </Button>\r\n                  </DialogTrigger>\r\n                  <DialogContent className=\"w-56 p-0\">\r\n                    <div className=\"p-4 border-b\">\r\n                      <p className=\"font-medium\">{session.user?.name}</p>\r\n                      <p className=\"text-sm text-muted-foreground\">{session.user?.email}</p>\r\n                    </div>\r\n                    <div className=\"p-2\">\r\n                      <Link href=\"/profile\" className=\"w-full\">\r\n                        <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n                          <UserIcon className=\"mr-2 h-4 w-4\" />\r\n                          Profile\r\n                        </Button>\r\n                      </Link>\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        className=\"w-full justify-start text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950\"\r\n                        onClick={handleSignOut}\r\n                      >\r\n                        <LogOutIcon className=\"mr-2 h-4 w-4\" />\r\n                        Sign out\r\n                      </Button>\r\n                    </div>\r\n                  </DialogContent>\r\n                </Dialog>\r\n              ) : (\r\n                <Button asChild>\r\n                  <Link href=\"/auth/signin\">\r\n                    <LogInIcon className=\"mr-2 h-4 w-4\" />\r\n                    Sign in\r\n                  </Link>\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Mobile Menu Button */}\r\n          <div className=\"md:hidden flex items-center gap-4\">\r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"icon\" \r\n              onClick={toggleTheme}\r\n              aria-label=\"Toggle theme\"\r\n            >\r\n              {theme === 'dark' ? <SunIcon className=\"h-5 w-5\" /> : <MoonIcon className=\"h-5 w-5\" />}\r\n            </Button>\r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"icon\"\r\n              onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\r\n            >\r\n              <MenuIcon className=\"h-5 w-5\" />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Mobile Menu */}\r\n        {mobileMenuOpen && (\r\n          <div className=\"md:hidden border-t\">\r\n            <div className=\"container py-4 space-y-4\">\r\n              <nav className=\"flex flex-col space-y-4\">\r\n                <Link \r\n                  href=\"/\" \r\n                  className=\"text-sm font-medium hover:text-primary\"\r\n                  onClick={() => setMobileMenuOpen(false)}\r\n                >\r\n                  Home\r\n                </Link>\r\n                <Link \r\n                  href=\"/explore\" \r\n                  className=\"text-sm font-medium hover:text-primary\"\r\n                  onClick={() => setMobileMenuOpen(false)}\r\n                >\r\n                  Explore\r\n                </Link>\r\n                {session && (\r\n                  <>\r\n                    <Link \r\n                      href=\"/dashboard\" \r\n                      className=\"text-sm font-medium hover:text-primary\"\r\n                      onClick={() => setMobileMenuOpen(false)}\r\n                    >\r\n                      Dashboard\r\n                    </Link>\r\n                    <Link \r\n                      href=\"/profile\" \r\n                      className=\"text-sm font-medium hover:text-primary\"\r\n                      onClick={() => setMobileMenuOpen(false)}\r\n                    >\r\n                      Profile\r\n                    </Link>\r\n                  </>\r\n                )}\r\n              </nav>\r\n              \r\n              <div className=\"pt-4 border-t\">\r\n                {status === 'loading' ? (\r\n                  <div className=\"h-9 w-full bg-muted animate-pulse rounded\"></div>\r\n                ) : session ? (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                      {session.user?.image ? (\r\n                        <img \r\n                          src={session.user.image} \r\n                          alt={session.user.name || 'User'} \r\n                          className=\"h-8 w-8 rounded-full\"\r\n                        />\r\n                      ) : (\r\n                        <UserIcon className=\"h-8 w-8 p-1 bg-muted rounded-full\" />\r\n                      )}\r\n                      <div>\r\n                        <p className=\"font-medium\">{session.user?.name}</p>\r\n                        <p className=\"text-sm text-muted-foreground\">{session.user?.email}</p>\r\n                      </div>\r\n                    </div>\r\n                    <Button \r\n                      variant=\"outline\" \r\n                      className=\"w-full justify-start\"\r\n                      onClick={handleSignOut}\r\n                    >\r\n                      <LogOutIcon className=\"mr-2 h-4 w-4\" />\r\n                      Sign out\r\n                    </Button>\r\n                  </div>\r\n                ) : (\r\n                  <Button \r\n                    className=\"w-full\" \r\n                    asChild\r\n                    onClick={() => setMobileMenuOpen(false)}\r\n                  >\r\n                    <Link href=\"/auth/signin\">\r\n                      <LogInIcon className=\"mr-2 h-4 w-4\" />\r\n                      Sign in\r\n                    </Link>\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </header>\r\n      <main className=\"container py-6\">\r\n        {children}\r\n      </main>\r\n      <footer className=\"border-t bg-background\">\r\n        <div className=\"container py-6 text-center text-sm text-muted-foreground\">\r\n          Â© {new Date().getFullYear()} MoodMash App\r\n        </div>\r\n      </footer>\r\n    </div>\r\n  );\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\mood\\mood-card.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\mood\\mood-creator-modal.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\mood\\mood-creator.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\mood\\mood-feed.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\ui\\button\\button.test.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\ui\\button\\button.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\ui\\card\\card.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\ui\\icons\\index.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\ui\\input\\slider.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\components\\ui\\modal\\dialog.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\context\\DirectionContext.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\entities\\mood.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\entities\\user.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\hooks\\useTranslation.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\api\\client.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 9,
        "column": 10,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 9,
        "endColumn": 13,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [218, 221], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [218, 221], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 18,
        "column": 36,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 18,
        "endColumn": 39,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [401, 404], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [401, 404], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 101,
        "column": 13,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 101,
        "endColumn": 16,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2536, 2539], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2536, 2539], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 104,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 104,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2691, 2694], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2691, 2694], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 104,
        "column": 44,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 104,
        "endColumn": 47,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2721, 2724], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2721, 2724], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 107,
        "column": 13,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 107,
        "endColumn": 16,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2861, 2864], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2861, 2864], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 107,
        "column": 43,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 107,
        "endColumn": 46,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2891, 2894], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2891, 2894], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 110,
        "column": 15,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 110,
        "endColumn": 18,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3032, 3035], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3032, 3035], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 110,
        "column": 45,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 110,
        "endColumn": 48,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3062, 3065], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3062, 3065], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 113,
        "column": 16,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 113,
        "endColumn": 19,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3206, 3209], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3206, 3209], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 10,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "/**\r\n * Client-side API utilities for making requests to our custom API routes\r\n */\r\n\r\ntype RequestMethod = 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\r\n\r\ninterface FetchOptions {\r\n  method?: RequestMethod;\r\n  body?: any;\r\n  headers?: Record<string, string>;\r\n  cache?: RequestCache;\r\n  revalidate?: number;\r\n}\r\n\r\n/**\r\n * Enhanced fetch wrapper for API calls\r\n */\r\nexport async function fetchAPI<T = any>(\r\n  endpoint: string, \r\n  options: FetchOptions = {}\r\n): Promise<T> {\r\n  const {\r\n    method = 'GET',\r\n    body,\r\n    headers = {},\r\n    cache,\r\n    revalidate,\r\n  } = options;\r\n\r\n  // Build the full URL if it's not already absolute\r\n  const url = endpoint.startsWith('http') \r\n    ? endpoint \r\n    : `/api${endpoint.startsWith('/') ? endpoint : `/${endpoint}`}`;\r\n\r\n  // Default headers\r\n  const defaultHeaders = {\r\n    'Content-Type': 'application/json',\r\n    'Accept': 'application/json',\r\n  };\r\n\r\n  // Prepare fetch options\r\n  const fetchOptions: RequestInit = {\r\n    method,\r\n    headers: { ...defaultHeaders, ...headers },\r\n    cache,\r\n    next: revalidate ? { revalidate } : undefined,\r\n  };\r\n\r\n  // Add body for non-GET requests\r\n  if (method !== 'GET' && body !== undefined) {\r\n    fetchOptions.body = JSON.stringify(body);\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(url, fetchOptions);\r\n    \r\n    // Handle non-JSON responses\r\n    const contentType = response.headers.get('content-type');\r\n    if (contentType?.includes('application/json')) {\r\n      const data = await response.json();\r\n      \r\n      // Check if request was successful\r\n      if (!response.ok) {\r\n        throw new Error(data.message || 'An error occurred');\r\n      }\r\n      \r\n      return data as T;\r\n    } else if (contentType?.includes('text/')) {\r\n      const text = await response.text();\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(text || 'An error occurred');\r\n      }\r\n      \r\n      return text as unknown as T;\r\n    } else {\r\n      // For other content types like blobs\r\n      const blob = await response.blob();\r\n      \r\n      if (!response.ok) {\r\n        throw new Error('An error occurred');\r\n      }\r\n      \r\n      return blob as unknown as T;\r\n    }\r\n  } catch (error) {\r\n    // Enhance error with additional context\r\n    if (error instanceof Error) {\r\n      console.error(`API request error (${url}):`, error);\r\n      throw error;\r\n    }\r\n    \r\n    throw new Error('Unknown error occurred during API request');\r\n  }\r\n}\r\n\r\n/**\r\n * Utility functions for common API operations\r\n */\r\nexport const api = {\r\n  get: <T = any>(endpoint: string, options?: Omit<FetchOptions, 'method' | 'body'>) => \r\n    fetchAPI<T>(endpoint, { ...options, method: 'GET' }),\r\n    \r\n  post: <T = any>(endpoint: string, data?: any, options?: Omit<FetchOptions, 'method'>) => \r\n    fetchAPI<T>(endpoint, { ...options, method: 'POST', body: data }),\r\n    \r\n  put: <T = any>(endpoint: string, data?: any, options?: Omit<FetchOptions, 'method'>) => \r\n    fetchAPI<T>(endpoint, { ...options, method: 'PUT', body: data }),\r\n    \r\n  patch: <T = any>(endpoint: string, data?: any, options?: Omit<FetchOptions, 'method'>) => \r\n    fetchAPI<T>(endpoint, { ...options, method: 'PATCH', body: data }),\r\n    \r\n  delete: <T = any>(endpoint: string, options?: Omit<FetchOptions, 'method'>) => \r\n    fetchAPI<T>(endpoint, { ...options, method: 'DELETE' }),\r\n}; ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\api\\handlers.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\api\\streaming.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 15,
        "column": 40,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 15,
        "endColumn": 43,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [450, 453], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [450, 453], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'closeOnComplete' is assigned a value but never used.",
        "line": 74,
        "column": 5,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 74,
        "endColumn": 20
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 120,
        "column": 18,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 120,
        "endColumn": 21,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3111, 3114], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3111, 3114], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 196,
        "column": 23,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 196,
        "endColumn": 26,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [4814, 4817], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [4814, 4817], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'event' is defined but never used.",
        "line": 247,
        "column": 30,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 247,
        "endColumn": 35
      }
    ],
    "suppressedMessages": [],
    "errorCount": 5,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "/**\r\n * Custom API streaming implementation for Next.js 13.5.6\r\n */\r\n\r\nimport { NextApiRequest, NextApiResponse } from 'next';\r\nimport { useState, useEffect, useRef, useCallback } from 'react';\r\n\r\n/**\r\n * Transforms stream data into the format required by Server-Sent Events (SSE)\r\n * \r\n * @param data The data to be sent in the stream\r\n * @param event Optional event name\r\n * @returns Formatted SSE data\r\n */\r\nexport function formatSSEMessage(data: any, event?: string): string {\r\n  const formattedData = typeof data === 'string' ? data : JSON.stringify(data);\r\n  let message = `data: ${formattedData}\\n\\n`;\r\n  \r\n  if (event) {\r\n    message = `event: ${event}\\n${message}`;\r\n  }\r\n  \r\n  return message;\r\n}\r\n\r\n/**\r\n * Options for the streaming response\r\n */\r\nexport interface StreamingOptions {\r\n  /**\r\n   * Headers to include in the response\r\n   */\r\n  headers?: Record<string, string>;\r\n  \r\n  /**\r\n   * Whether to keep connection alive with periodic heartbeat\r\n   */\r\n  keepAlive?: boolean;\r\n  \r\n  /**\r\n   * Interval for sending heartbeat messages (in ms)\r\n   */\r\n  heartbeatInterval?: number;\r\n  \r\n  /**\r\n   * Whether to close the connection after all data is sent\r\n   */\r\n  closeOnComplete?: boolean;\r\n}\r\n\r\nconst DEFAULT_STREAMING_OPTIONS: StreamingOptions = {\r\n  keepAlive: true,\r\n  heartbeatInterval: 15000, // 15 seconds\r\n  closeOnComplete: false,\r\n};\r\n\r\n/**\r\n * Creates a streaming response\r\n * \r\n * @param req NextApiRequest\r\n * @param res NextApiResponse\r\n * @param options Options for the streaming response\r\n * @returns Object with methods to send data through the stream\r\n */\r\nexport function createStreamingResponse(\r\n  req: NextApiRequest,\r\n  res: NextApiResponse,\r\n  options: StreamingOptions = {}\r\n) {\r\n  const {\r\n    headers = {},\r\n    keepAlive = DEFAULT_STREAMING_OPTIONS.keepAlive,\r\n    heartbeatInterval = DEFAULT_STREAMING_OPTIONS.heartbeatInterval,\r\n    closeOnComplete = DEFAULT_STREAMING_OPTIONS.closeOnComplete,\r\n  } = options;\r\n  \r\n  // Set up SSE headers\r\n  res.setHeader('Content-Type', 'text/event-stream');\r\n  res.setHeader('Cache-Control', 'no-cache, no-transform');\r\n  res.setHeader('Connection', 'keep-alive');\r\n  res.setHeader('X-Accel-Buffering', 'no'); // Disable buffering for Nginx\r\n  \r\n  // Set custom headers\r\n  Object.entries(headers).forEach(([key, value]) => {\r\n    res.setHeader(key, value);\r\n  });\r\n  \r\n  // Initialize response\r\n  res.status(200);\r\n  res.flushHeaders();\r\n  \r\n  // Keep track of connection status\r\n  let closed = false;\r\n  \r\n  // Set up heartbeat interval if required\r\n  let heartbeatTimer: NodeJS.Timeout | null = null;\r\n  \r\n  if (keepAlive) {\r\n    heartbeatTimer = setInterval(() => {\r\n      if (!closed) {\r\n        res.write(formatSSEMessage({ type: 'heartbeat', timestamp: Date.now() }, 'heartbeat'));\r\n      }\r\n    }, heartbeatInterval);\r\n  }\r\n  \r\n  // Handle client disconnect\r\n  req.on('close', () => {\r\n    closed = true;\r\n    \r\n    if (heartbeatTimer) {\r\n      clearInterval(heartbeatTimer);\r\n    }\r\n  });\r\n  \r\n  // Return methods to manipulate the stream\r\n  return {\r\n    /**\r\n     * Send data through the stream\r\n     */\r\n    send: (data: any, event?: string) => {\r\n      if (!closed) {\r\n        res.write(formatSSEMessage(data, event));\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * Send error through the stream\r\n     */\r\n    error: (error: Error | string) => {\r\n      if (!closed) {\r\n        const message = error instanceof Error ? error.message : error;\r\n        res.write(formatSSEMessage({ error: message }, 'error'));\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * Check if connection is closed\r\n     */\r\n    isClosed: () => closed,\r\n    \r\n    /**\r\n     * Close the stream\r\n     */\r\n    close: () => {\r\n      if (!closed) {\r\n        closed = true;\r\n        \r\n        if (heartbeatTimer) {\r\n          clearInterval(heartbeatTimer);\r\n        }\r\n        \r\n        res.end();\r\n      }\r\n    },\r\n  };\r\n}\r\n\r\n/**\r\n * Creates a streaming response with async iterator\r\n * \r\n * @param req NextApiRequest\r\n * @param res NextApiResponse\r\n * @param dataSource Async iterable source of data\r\n * @param options Options for the streaming response\r\n */\r\nexport async function streamAsyncIterable<T>(\r\n  req: NextApiRequest,\r\n  res: NextApiResponse,\r\n  dataSource: AsyncIterable<T>,\r\n  options?: StreamingOptions\r\n) {\r\n  const stream = createStreamingResponse(req, res, options);\r\n  \r\n  try {\r\n    for await (const data of dataSource) {\r\n      if (stream.isClosed()) break;\r\n      stream.send(data);\r\n    }\r\n    \r\n    if (options?.closeOnComplete) {\r\n      stream.close();\r\n    }\r\n  } catch (error) {\r\n    stream.error(error as Error);\r\n    stream.close();\r\n  }\r\n}\r\n\r\n/**\r\n * Custom hook for client-side usage of streaming endpoints\r\n */\r\nexport function useStreamingData<T>(\r\n  url: string,\r\n  options?: {\r\n    onMessage?: (data: T) => void;\r\n    onError?: (error: any) => void;\r\n    onOpen?: () => void;\r\n    onClose?: () => void;\r\n    autoConnect?: boolean;\r\n  }\r\n) {\r\n  const {\r\n    onMessage,\r\n    onError,\r\n    onOpen,\r\n    onClose,\r\n    autoConnect = true,\r\n  } = options || {};\r\n  \r\n  const [data, setData] = useState<T | null>(null);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const eventSourceRef = useRef<EventSource | null>(null);\r\n  \r\n  const connect = useCallback(() => {\r\n    if (typeof window === 'undefined') return;\r\n    \r\n    if (eventSourceRef.current) {\r\n      eventSourceRef.current.close();\r\n    }\r\n    \r\n    try {\r\n      const eventSource = new EventSource(url);\r\n      eventSourceRef.current = eventSource;\r\n      \r\n      eventSource.onopen = () => {\r\n        setIsConnected(true);\r\n        setError(null);\r\n        if (onOpen) onOpen();\r\n      };\r\n      \r\n      eventSource.onmessage = (event) => {\r\n        try {\r\n          const parsedData = JSON.parse(event.data) as T;\r\n          setData(parsedData);\r\n          if (onMessage) onMessage(parsedData);\r\n        } catch (err) {\r\n          const error = err instanceof Error \r\n            ? err \r\n            : new Error('Failed to parse streaming data');\r\n          \r\n          setError(error);\r\n          if (onError) onError(error);\r\n        }\r\n      };\r\n      \r\n      eventSource.onerror = (event) => {\r\n        const error = new Error('EventSource connection error');\r\n        setError(error);\r\n        setIsConnected(false);\r\n        \r\n        if (onError) onError(error);\r\n        eventSource.close();\r\n        eventSourceRef.current = null;\r\n      };\r\n      \r\n      // Set up event handlers for custom events\r\n      eventSource.addEventListener('error', (event) => {\r\n        try {\r\n          const parsedData = JSON.parse((event as MessageEvent).data);\r\n          const error = new Error(parsedData.error || 'Unknown streaming error');\r\n          \r\n          setError(error);\r\n          if (onError) onError(error);\r\n        } catch (err) {\r\n          const error = err instanceof Error \r\n            ? err \r\n            : new Error('Failed to parse error data');\r\n          \r\n          setError(error);\r\n          if (onError) onError(error);\r\n        }\r\n      });\r\n      \r\n      // Don't update state for heartbeat events\r\n      eventSource.addEventListener('heartbeat', () => {});\r\n      \r\n      return () => {\r\n        eventSource.close();\r\n        eventSourceRef.current = null;\r\n        setIsConnected(false);\r\n        if (onClose) onClose();\r\n      };\r\n    } catch (err) {\r\n      const error = err instanceof Error \r\n        ? err \r\n        : new Error('Failed to connect to streaming endpoint');\r\n      \r\n      setError(error);\r\n      setIsConnected(false);\r\n      \r\n      if (onError) onError(error);\r\n      return undefined;\r\n    }\r\n  }, [url, onMessage, onError, onOpen, onClose]);\r\n  \r\n  const disconnect = useCallback(() => {\r\n    if (eventSourceRef.current) {\r\n      eventSourceRef.current.close();\r\n      eventSourceRef.current = null;\r\n      setIsConnected(false);\r\n      if (onClose) onClose();\r\n    }\r\n  }, [onClose]);\r\n  \r\n  // Connect on mount if autoConnect is true\r\n  useEffect(() => {\r\n    if (autoConnect) {\r\n      const cleanup = connect();\r\n      return cleanup;\r\n    }\r\n    return undefined;\r\n  }, [autoConnect, connect]);\r\n  \r\n  return {\r\n    data,\r\n    error,\r\n    isConnected,\r\n    connect,\r\n    disconnect,\r\n  };\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\auth\\auth-options.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\auth\\auth.config.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\auth\\auth.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\auth\\mfa.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'crypto' is defined but never used.",
        "line": 4,
        "column": 8,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 4,
        "endColumn": 14
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { authenticator } from 'otplib';\r\nimport QRCode from 'qrcode';\r\nimport { db } from '@/lib/db/prisma';\r\nimport crypto from 'crypto';\r\nimport { nanoid } from 'nanoid';\r\n\r\n// Generate a new MFA secret for a user\r\nexport async function generateMfaSecret(\r\n  userId: string,\r\n  email: string\r\n): Promise<{\r\n  secret: string;\r\n  qrCodeUrl: string;\r\n  backupCodes: string[];\r\n}> {\r\n  // Generate a new secret\r\n  const secret = authenticator.generateSecret();\r\n  \r\n  // Generate the QR code URL\r\n  const serviceName = process.env.MFA_SERVICE_NAME || 'MoodMash';\r\n  const qrCodeUrl = authenticator.keyuri(email, serviceName, secret);\r\n  \r\n  // Generate backup codes\r\n  const backupCodes = generateBackupCodes();\r\n  \r\n  // Store backup codes in the database\r\n  await db.user.update({\r\n    where: { id: userId },\r\n    data: {\r\n      mfaSecret: secret,\r\n      mfaBackupCodes: backupCodes,\r\n      // Note: mfaEnabled remains false until verified\r\n    },\r\n  });\r\n  \r\n  return {\r\n    secret,\r\n    qrCodeUrl,\r\n    backupCodes,\r\n  };\r\n}\r\n\r\n/**\r\n * Generate backup codes for MFA\r\n */\r\nfunction generateBackupCodes(count = 10, length = 8): string[] {\r\n  const codes: string[] = [];\r\n  \r\n  for (let i = 0; i < count; i++) {\r\n    codes.push(nanoid(length));\r\n  }\r\n  \r\n  return codes;\r\n}\r\n\r\n// Verify a TOTP code\r\nexport function verifyTOTP(token: string, secret: string): boolean {\r\n  try {\r\n    return authenticator.verify({ token, secret });\r\n  } catch (error) {\r\n    console.error('TOTP verification error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Enable MFA for a user\r\nexport async function enableMfa(userId: string): Promise<void> {\r\n  await db.user.update({\r\n    where: { id: userId },\r\n    data: {\r\n      mfaEnabled: true,\r\n    },\r\n  });\r\n}\r\n\r\n// Disable MFA for a user\r\nexport async function disableMfa(userId: string): Promise<void> {\r\n  await db.user.update({\r\n    where: { id: userId },\r\n    data: {\r\n      mfaEnabled: false,\r\n      mfaSecret: null,\r\n      mfaBackupCodes: [],\r\n    },\r\n  });\r\n}\r\n\r\n// Verify a backup code\r\nexport async function verifyBackupCode(userId: string, code: string): Promise<boolean> {\r\n  const user = await db.user.findUnique({\r\n    where: { id: userId },\r\n    select: { mfaBackupCodes: true },\r\n  });\r\n  \r\n  if (!user || !user.mfaBackupCodes || user.mfaBackupCodes.length === 0) {\r\n    return false;\r\n  }\r\n  \r\n  const backupCodes = user.mfaBackupCodes;\r\n  const codeIndex = backupCodes.indexOf(code);\r\n  \r\n  if (codeIndex === -1) {\r\n    return false;\r\n  }\r\n  \r\n  // Remove the used backup code\r\n  const updatedBackupCodes = [...backupCodes];\r\n  updatedBackupCodes.splice(codeIndex, 1);\r\n  \r\n  // Update the user's backup codes\r\n  await db.user.update({\r\n    where: { id: userId },\r\n    data: {\r\n      mfaBackupCodes: updatedBackupCodes,\r\n    },\r\n  });\r\n  \r\n  return true;\r\n}\r\n\r\n// Function to generate a QR code for TOTP setup\r\nexport async function generateTOTPQRCode(secret: string, email: string): Promise<string> {\r\n  try {\r\n    const otpauth = authenticator.keyuri(email, 'MoodMash', secret);\r\n    return await QRCode.toDataURL(otpauth);\r\n  } catch {\r\n    throw new Error('Failed to generate QR code');\r\n  }\r\n}\r\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\auth\\password.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\auth\\rate-limit.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\auth\\token.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\auth\\utils.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\auth\\webauthn.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\db.ts",
    "messages": [
      {
        "ruleId": "no-var",
        "severity": 2,
        "message": "Unexpected var, use let or const instead.",
        "line": 5,
        "column": 3,
        "nodeType": "VariableDeclaration",
        "messageId": "unexpectedVar",
        "endLine": 5,
        "endColumn": 40
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { PrismaClient } from '@prisma/client';\r\n\r\n// Prevent multiple instances of Prisma Client in development\r\ndeclare global {\r\n  var prisma: PrismaClient | undefined;\r\n}\r\n\r\nexport const prisma = global.prisma || new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== 'production') {\r\n  global.prisma = prisma;\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\db\\prisma.ts",
    "messages": [],
    "suppressedMessages": [
      {
        "ruleId": "no-var",
        "severity": 2,
        "message": "Unexpected var, use let or const instead.",
        "line": 6,
        "column": 3,
        "nodeType": "VariableDeclaration",
        "messageId": "unexpectedVar",
        "endLine": 6,
        "endColumn": 40,
        "suppressions": [{ "kind": "directive", "justification": "" }]
      }
    ],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\email\\sendPasswordResetEmail.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\email\\sendVerificationEmail.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\encryption\\crypto.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'KEY_LENGTH' is assigned a value but never used.",
        "line": 16,
        "column": 7,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 16,
        "endColumn": 17
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'SECRET_LENGTH' is assigned a value but never used.",
        "line": 17,
        "column": 7,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 17,
        "endColumn": 20
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'AUTH_KEY_LENGTH' is assigned a value but never used.",
        "line": 20,
        "column": 7,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 20,
        "endColumn": 22
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 41,
        "column": 20,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 41,
        "endColumn": 23,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1320, 1323], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1320, 1323], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 308,
        "column": 45,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 308,
        "endColumn": 48,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [9172, 9175], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [9172, 9175], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 334,
        "column": 4,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 334,
        "endColumn": 7,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [9770, 9773], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [9770, 9773], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'e' is defined but never used.",
        "line": 345,
        "column": 12,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 345,
        "endColumn": 13
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 384,
        "column": 16,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 384,
        "endColumn": 19,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [11021, 11024], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [11021, 11024], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 399,
        "column": 4,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 399,
        "endColumn": 7,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [11412, 11415], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [11412, 11415], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 9,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import nacl from 'tweetnacl';\r\nimport util from 'tweetnacl-util';\r\nimport SRP from 'secure-remote-password/client';\r\nimport { Crypto } from '@peculiar/webcrypto';\r\n\r\n// Polyfill for WebCrypto API in non-browser environments\r\nif (typeof window === 'undefined' && !global.crypto) {\r\n  global.crypto = new Crypto();\r\n}\r\n\r\n/**\r\n * Encryption utility functions for end-to-end encryption\r\n */\r\n\r\n// Constants for encryption\r\nconst KEY_LENGTH = nacl.box.publicKeyLength;\r\nconst SECRET_LENGTH = nacl.box.secretKeyLength;\r\nconst NONCE_LENGTH = nacl.box.nonceLength;\r\nconst SALT_BYTES = 16;\r\nconst AUTH_KEY_LENGTH = 32;\r\n\r\n// Types for encryption\r\nexport interface EncryptedData {\r\n  ciphertext: string; // Base64 encoded encrypted data\r\n  nonce: string; // Base64 encoded nonce\r\n  publicKey?: string; // Sender's public key if using asymmetric encryption\r\n}\r\n\r\nexport interface UserKeys {\r\n  publicKey: string; // Base64 encoded public key\r\n  secretKey: string; // Base64 encoded secret key (never stored on server)\r\n  salt: string; // Base64 encoded salt used for key derivation\r\n}\r\n\r\nexport interface EncryptedMessage extends EncryptedData {\r\n  sender: string; // User ID of sender\r\n  recipient: string; // User ID of recipient\r\n  timestamp: number; // Creation timestamp\r\n  metadata?: {\r\n    type: string;\r\n    [key: string]: any;\r\n  };\r\n}\r\n\r\n/**\r\n * Generate a random nonce for encryption\r\n */\r\nexport function generateNonce(): Uint8Array {\r\n  return nacl.randomBytes(NONCE_LENGTH);\r\n}\r\n\r\n/**\r\n * Generate a random salt for key derivation\r\n */\r\nexport function generateSalt(): Uint8Array {\r\n  return nacl.randomBytes(SALT_BYTES);\r\n}\r\n\r\n/**\r\n * Generate a new key pair for asymmetric encryption\r\n */\r\nexport function generateKeyPair(): nacl.BoxKeyPair {\r\n  return nacl.box.keyPair();\r\n}\r\n\r\n/**\r\n * Convert a string to Uint8Array\r\n */\r\nexport function stringToUint8Array(str: string): Uint8Array {\r\n  return util.decodeUTF8(str);\r\n}\r\n\r\n/**\r\n * Convert Uint8Array to string\r\n */\r\nexport function uint8ArrayToString(arr: Uint8Array): string {\r\n  return util.encodeUTF8(arr);\r\n}\r\n\r\n/**\r\n * Encode Uint8Array to Base64 string\r\n */\r\nexport function encodeBase64(arr: Uint8Array): string {\r\n  return util.encodeBase64(arr);\r\n}\r\n\r\n/**\r\n * Decode Base64 string to Uint8Array\r\n */\r\nexport function decodeBase64(str: string): Uint8Array {\r\n  return util.decodeBase64(str);\r\n}\r\n\r\n/**\r\n * Derive encryption key from password\r\n * @param password User password\r\n * @param salt Random salt (should be stored with user)\r\n * @returns Promise resolving to the derived key\r\n */\r\nexport async function deriveKeyFromPassword(\r\n  password: string, \r\n  salt: Uint8Array | string\r\n): Promise<Uint8Array> {\r\n  const encoder = new TextEncoder();\r\n  const passwordBuffer = encoder.encode(password);\r\n  const saltBuffer = typeof salt === 'string' ? decodeBase64(salt) : salt;\r\n  \r\n  // Import the password as a key\r\n  const passwordKey = await crypto.subtle.importKey(\r\n    'raw', \r\n    passwordBuffer,\r\n    { name: 'PBKDF2' }, \r\n    false, \r\n    ['deriveBits']\r\n  );\r\n  \r\n  // Derive bits using PBKDF2\r\n  const derivedBits = await crypto.subtle.deriveBits(\r\n    {\r\n      name: 'PBKDF2',\r\n      salt: saltBuffer,\r\n      iterations: 100000,\r\n      hash: 'SHA-256',\r\n    },\r\n    passwordKey,\r\n    256 // 32 bytes for NaCl box\r\n  );\r\n  \r\n  return new Uint8Array(derivedBits);\r\n}\r\n\r\n/**\r\n * Encrypt data with symmetric encryption (secret key)\r\n * @param data Data to encrypt\r\n * @param key Secret key (Uint8Array or Base64 string)\r\n * @returns Encrypted data object with ciphertext and nonce\r\n */\r\nexport function encryptSymmetric(\r\n  data: string | object, \r\n  key: Uint8Array | string\r\n): EncryptedData {\r\n  // Convert key if it's a string\r\n  const keyArray = typeof key === 'string' ? decodeBase64(key) : key;\r\n  \r\n  // Convert data to string if it's an object\r\n  const dataString = typeof data === 'object' ? JSON.stringify(data) : data;\r\n  \r\n  // Generate a random nonce\r\n  const nonce = generateNonce();\r\n  \r\n  // Encrypt the data\r\n  const dataUint8 = stringToUint8Array(dataString);\r\n  const encrypted = nacl.secretbox(dataUint8, nonce, keyArray);\r\n  \r\n  return {\r\n    ciphertext: encodeBase64(encrypted),\r\n    nonce: encodeBase64(nonce),\r\n  };\r\n}\r\n\r\n/**\r\n * Decrypt data with symmetric encryption (secret key)\r\n * @param encryptedData Object containing ciphertext and nonce\r\n * @param key Secret key (Uint8Array or Base64 string)\r\n * @returns Decrypted data string\r\n */\r\nexport function decryptSymmetric(\r\n  encryptedData: EncryptedData,\r\n  key: Uint8Array | string\r\n): string | null {\r\n  // Convert key if it's a string\r\n  const keyArray = typeof key === 'string' ? decodeBase64(key) : key;\r\n  \r\n  // Decode the ciphertext and nonce\r\n  const ciphertext = decodeBase64(encryptedData.ciphertext);\r\n  const nonce = decodeBase64(encryptedData.nonce);\r\n  \r\n  // Decrypt the data\r\n  const decrypted = nacl.secretbox.open(ciphertext, nonce, keyArray);\r\n  \r\n  // Return null if decryption failed\r\n  if (!decrypted) return null;\r\n  \r\n  // Convert the decrypted data to a string\r\n  return uint8ArrayToString(decrypted);\r\n}\r\n\r\n/**\r\n * Encrypt data with asymmetric encryption (public key)\r\n * @param data Data to encrypt\r\n * @param recipientPublicKey Recipient's public key (Uint8Array or Base64 string)\r\n * @param senderSecretKey Sender's secret key (Uint8Array or Base64 string)\r\n * @returns Encrypted data object with ciphertext, nonce, and sender's public key\r\n */\r\nexport function encryptAsymmetric(\r\n  data: string | object,\r\n  recipientPublicKey: Uint8Array | string,\r\n  senderSecretKey: Uint8Array | string\r\n): EncryptedData {\r\n  // Convert keys if they're strings\r\n  const publicKeyArray = typeof recipientPublicKey === 'string' \r\n    ? decodeBase64(recipientPublicKey) \r\n    : recipientPublicKey;\r\n    \r\n  const secretKeyArray = typeof senderSecretKey === 'string'\r\n    ? decodeBase64(senderSecretKey)\r\n    : senderSecretKey;\r\n  \r\n  // Generate keypair from sender's secret key\r\n  const keyPair = nacl.box.keyPair.fromSecretKey(secretKeyArray);\r\n  \r\n  // Convert data to string if it's an object\r\n  const dataString = typeof data === 'object' ? JSON.stringify(data) : data;\r\n  \r\n  // Generate a random nonce\r\n  const nonce = generateNonce();\r\n  \r\n  // Encrypt the data\r\n  const dataUint8 = stringToUint8Array(dataString);\r\n  const encrypted = nacl.box(\r\n    dataUint8,\r\n    nonce,\r\n    publicKeyArray,\r\n    secretKeyArray\r\n  );\r\n  \r\n  return {\r\n    ciphertext: encodeBase64(encrypted),\r\n    nonce: encodeBase64(nonce),\r\n    publicKey: encodeBase64(keyPair.publicKey), // Sender's public key\r\n  };\r\n}\r\n\r\n/**\r\n * Decrypt data with asymmetric encryption (private key)\r\n * @param encryptedData Object containing ciphertext, nonce, and sender's public key\r\n * @param recipientSecretKey Recipient's secret key (Uint8Array or Base64 string)\r\n * @param senderPublicKey Sender's public key (Uint8Array or Base64 string) - if not in encryptedData\r\n * @returns Decrypted data string\r\n */\r\nexport function decryptAsymmetric(\r\n  encryptedData: EncryptedData,\r\n  recipientSecretKey: Uint8Array | string,\r\n  senderPublicKey?: Uint8Array | string\r\n): string | null {\r\n  if (!encryptedData.publicKey && !senderPublicKey) {\r\n    throw new Error('Sender public key is required for decryption');\r\n  }\r\n  \r\n  // Convert key if it's a string\r\n  const secretKeyArray = typeof recipientSecretKey === 'string'\r\n    ? decodeBase64(recipientSecretKey)\r\n    : recipientSecretKey;\r\n    \r\n  // Use sender's public key from encryptedData or provided parameter\r\n  const publicKeyString = encryptedData.publicKey || senderPublicKey as string;\r\n  const publicKeyArray = typeof publicKeyString === 'string'\r\n    ? decodeBase64(publicKeyString)\r\n    : publicKeyString;\r\n  \r\n  // Decode the ciphertext and nonce\r\n  const ciphertext = decodeBase64(encryptedData.ciphertext);\r\n  const nonce = decodeBase64(encryptedData.nonce);\r\n  \r\n  // Decrypt the data\r\n  const decrypted = nacl.box.open(\r\n    ciphertext,\r\n    nonce,\r\n    publicKeyArray,\r\n    secretKeyArray\r\n  );\r\n  \r\n  // Return null if decryption failed\r\n  if (!decrypted) return null;\r\n  \r\n  // Convert the decrypted data to a string\r\n  return uint8ArrayToString(decrypted);\r\n}\r\n\r\n/**\r\n * Generate a verifier and salt for Secure Remote Password protocol\r\n * @param username User's username\r\n * @param password User's password\r\n * @returns Object containing salt and verifier\r\n */\r\nexport function generateSrpCredentials(username: string, password: string) {\r\n  const salt = SRP.generateSalt();\r\n  const privateKey = SRP.derivePrivateKey(salt, username, password);\r\n  const verifier = SRP.deriveVerifier(privateKey);\r\n  \r\n  return { salt, verifier };\r\n}\r\n\r\n/**\r\n * Create an encrypted message for secure communication\r\n * @param message Message content\r\n * @param senderKeys Sender's keys\r\n * @param recipientPublicKey Recipient's public key\r\n * @param metadata Optional metadata for the message\r\n * @returns Encrypted message object\r\n */\r\nexport function createEncryptedMessage(\r\n  message: string | object,\r\n  senderKeys: { secretKey: string; publicKey: string },\r\n  recipientPublicKey: string,\r\n  senderId: string,\r\n  recipientId: string,\r\n  metadata?: { type: string; [key: string]: any }\r\n): EncryptedMessage {\r\n  const encrypted = encryptAsymmetric(\r\n    message,\r\n    recipientPublicKey,\r\n    senderKeys.secretKey\r\n  );\r\n  \r\n  return {\r\n    ...encrypted,\r\n    sender: senderId,\r\n    recipient: recipientId,\r\n    timestamp: Date.now(),\r\n    metadata,\r\n  };\r\n}\r\n\r\n/**\r\n * Decrypt an encrypted message\r\n * @param encryptedMessage The encrypted message object\r\n * @param recipientSecretKey Recipient's secret key\r\n * @returns Decrypted message as string or parsed object\r\n */\r\nexport function decryptMessage(\r\n  encryptedMessage: EncryptedMessage,\r\n  recipientSecretKey: string\r\n): any {\r\n  const decrypted = decryptAsymmetric(\r\n    encryptedMessage,\r\n    recipientSecretKey\r\n  );\r\n  \r\n  if (!decrypted) return null;\r\n  \r\n  try {\r\n    // Try to parse as JSON\r\n    return JSON.parse(decrypted);\r\n  } catch (e) {\r\n    // Return as string if not valid JSON\r\n    return decrypted;\r\n  }\r\n}\r\n\r\n/**\r\n * Generate encryption keys from user credentials\r\n * @param email User's email\r\n * @param password User's password\r\n * @returns Promise resolving to user keys\r\n */\r\nexport async function generateUserKeys(\r\n  email: string,\r\n  password: string\r\n): Promise<UserKeys> {\r\n  // Generate a salt\r\n  const salt = generateSalt();\r\n  \r\n  // Derive a key from the password\r\n  const derivedKey = await deriveKeyFromPassword(password, salt);\r\n  \r\n  // Generate a key pair from the derived key\r\n  const keyPair = nacl.box.keyPair.fromSecretKey(derivedKey);\r\n  \r\n  return {\r\n    publicKey: encodeBase64(keyPair.publicKey),\r\n    secretKey: encodeBase64(keyPair.secretKey),\r\n    salt: encodeBase64(salt),\r\n  };\r\n}\r\n\r\n/**\r\n * Encrypt user preferences with symmetric encryption\r\n * @param preferences User preferences object\r\n * @param encryptionKey Encryption key\r\n * @returns Encrypted data object\r\n */\r\nexport function encryptPreferences(\r\n  preferences: any,\r\n  encryptionKey: string\r\n): EncryptedData {\r\n  return encryptSymmetric(preferences, encryptionKey);\r\n}\r\n\r\n/**\r\n * Decrypt user preferences\r\n * @param encryptedData Encrypted preferences data\r\n * @param encryptionKey Encryption key\r\n * @returns Decrypted preferences object or null\r\n */\r\nexport function decryptPreferences(\r\n  encryptedData: EncryptedData,\r\n  encryptionKey: string\r\n): any {\r\n  const decrypted = decryptSymmetric(encryptedData, encryptionKey);\r\n  \r\n  if (!decrypted) return null;\r\n  \r\n  try {\r\n    return JSON.parse(decrypted);\r\n  } catch (e) {\r\n    console.error('Failed to parse decrypted preferences:', e);\r\n    return null;\r\n  }\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\encryption\\keyManager.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'decodeBase64' is defined but never used.",
        "line": 1,
        "column": 34,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 1,
        "endColumn": 46
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { UserKeys, encodeBase64, decodeBase64, deriveKeyFromPassword } from './crypto';\r\n\r\n// Constants\r\nconst KEY_PREFIX = 'moodmash_keys_';\r\nconst PUBLIC_KEY_SUFFIX = '_public';\r\nconst ENC_KEY_STORAGE_KEY = 'moodmash_enc_key';\r\nconst KEY_META_STORAGE_KEY = 'moodmash_key_meta';\r\n\r\n/**\r\n * Interface for key metadata\r\n */\r\nexport interface KeyMetadata {\r\n  userId: string;\r\n  keyId: string;\r\n  createdAt: number;\r\n  updatedAt: number;\r\n  publicKeyShared: boolean;\r\n  deviceId: string;\r\n  keyType: 'primary' | 'recovery' | 'device';\r\n}\r\n\r\n/**\r\n * Client-side key manager for handling encryption keys\r\n */\r\nexport class KeyManager {\r\n  private userId: string | null = null;\r\n  private secretKey: string | null = null;\r\n  private publicKey: string | null = null;\r\n  private encryptionKey: string | null = null;\r\n  private salt: string | null = null;\r\n  private metadata: KeyMetadata | null = null;\r\n  private storage: Storage | null = null;\r\n  \r\n  constructor(userId?: string) {\r\n    if (typeof window !== 'undefined') {\r\n      this.storage = window.localStorage;\r\n      if (userId) {\r\n        this.userId = userId;\r\n        this.loadKeysFromStorage();\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Initialize the key manager with user ID\r\n   * @param userId User's ID\r\n   */\r\n  public initialize(userId: string): void {\r\n    this.userId = userId;\r\n    this.loadKeysFromStorage();\r\n  }\r\n  \r\n  /**\r\n   * Check if keys exist for the current user\r\n   */\r\n  public hasKeys(): boolean {\r\n    return !!(this.secretKey && this.publicKey);\r\n  }\r\n  \r\n  /**\r\n   * Set user keys\r\n   * @param keys UserKeys object\r\n   * @param metadata Optional key metadata\r\n   */\r\n  public setKeys(keys: UserKeys, metadata?: Partial<KeyMetadata>): void {\r\n    if (!this.userId) {\r\n      throw new Error('User ID not set. Call initialize() first.');\r\n    }\r\n    \r\n    this.secretKey = keys.secretKey;\r\n    this.publicKey = keys.publicKey;\r\n    this.salt = keys.salt;\r\n    \r\n    const now = Date.now();\r\n    const deviceId = this.getOrCreateDeviceId();\r\n    \r\n    this.metadata = {\r\n      userId: this.userId,\r\n      keyId: `key_${now}_${Math.random().toString(36).substring(2, 9)}`,\r\n      createdAt: now,\r\n      updatedAt: now,\r\n      publicKeyShared: false,\r\n      deviceId,\r\n      keyType: 'primary',\r\n      ...metadata\r\n    };\r\n    \r\n    this.saveKeysToStorage();\r\n  }\r\n  \r\n  /**\r\n   * Get user's public key\r\n   */\r\n  public getPublicKey(): string | null {\r\n    return this.publicKey;\r\n  }\r\n  \r\n  /**\r\n   * Get user's secret key (private)\r\n   * Should be used carefully and never exposed\r\n   */\r\n  public getSecretKey(): string | null {\r\n    return this.secretKey;\r\n  }\r\n  \r\n  /**\r\n   * Get user keys\r\n   */\r\n  public getKeys(): { publicKey: string; secretKey: string } | null {\r\n    if (!this.publicKey || !this.secretKey) {\r\n      return null;\r\n    }\r\n    \r\n    return {\r\n      publicKey: this.publicKey,\r\n      secretKey: this.secretKey\r\n    };\r\n  }\r\n  \r\n  /**\r\n   * Get key metadata\r\n   */\r\n  public getMetadata(): KeyMetadata | null {\r\n    return this.metadata;\r\n  }\r\n  \r\n  /**\r\n   * Derive and set encryption key from password\r\n   * @param password User's password\r\n   */\r\n  public async setEncryptionKeyFromPassword(password: string): Promise<string> {\r\n    if (!this.salt) {\r\n      throw new Error('Salt not available. Set keys first.');\r\n    }\r\n    \r\n    const derivedKey = await deriveKeyFromPassword(password, this.salt);\r\n    this.encryptionKey = encodeBase64(derivedKey);\r\n    \r\n    if (this.storage) {\r\n      // Store temporarily in sessionStorage for the session duration\r\n      sessionStorage.setItem(ENC_KEY_STORAGE_KEY, this.encryptionKey);\r\n    }\r\n    \r\n    return this.encryptionKey;\r\n  }\r\n  \r\n  /**\r\n   * Get the encryption key\r\n   */\r\n  public getEncryptionKey(): string | null {\r\n    // Try to get from memory first, then from session storage\r\n    if (!this.encryptionKey && typeof sessionStorage !== 'undefined') {\r\n      this.encryptionKey = sessionStorage.getItem(ENC_KEY_STORAGE_KEY);\r\n    }\r\n    \r\n    return this.encryptionKey;\r\n  }\r\n  \r\n  /**\r\n   * Clear encryption key from memory and session storage\r\n   */\r\n  public clearEncryptionKey(): void {\r\n    this.encryptionKey = null;\r\n    if (typeof sessionStorage !== 'undefined') {\r\n      sessionStorage.removeItem(ENC_KEY_STORAGE_KEY);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Mark public key as shared with server\r\n   */\r\n  public markPublicKeyAsShared(): void {\r\n    if (this.metadata) {\r\n      this.metadata.publicKeyShared = true;\r\n      this.metadata.updatedAt = Date.now();\r\n      this.saveMetadataToStorage();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Clear all keys from memory and storage\r\n   */\r\n  public clearKeys(): void {\r\n    this.secretKey = null;\r\n    this.publicKey = null;\r\n    this.encryptionKey = null;\r\n    this.salt = null;\r\n    this.metadata = null;\r\n    \r\n    if (this.storage && this.userId) {\r\n      this.storage.removeItem(`${KEY_PREFIX}${this.userId}`);\r\n      this.storage.removeItem(`${KEY_PREFIX}${this.userId}${PUBLIC_KEY_SUFFIX}`);\r\n      this.storage.removeItem(`${KEY_META_STORAGE_KEY}_${this.userId}`);\r\n    }\r\n    \r\n    if (typeof sessionStorage !== 'undefined') {\r\n      sessionStorage.removeItem(ENC_KEY_STORAGE_KEY);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Load keys from storage\r\n   */\r\n  private loadKeysFromStorage(): void {\r\n    if (!this.storage || !this.userId) return;\r\n    \r\n    try {\r\n      // Load secret key (encrypted)\r\n      const encryptedSecretKey = this.storage.getItem(`${KEY_PREFIX}${this.userId}`);\r\n      if (encryptedSecretKey) {\r\n        this.secretKey = encryptedSecretKey;\r\n      }\r\n      \r\n      // Load public key (can be stored in clear)\r\n      const publicKey = this.storage.getItem(`${KEY_PREFIX}${this.userId}${PUBLIC_KEY_SUFFIX}`);\r\n      if (publicKey) {\r\n        this.publicKey = publicKey;\r\n      }\r\n      \r\n      // Load salt\r\n      const salt = this.storage.getItem(`${KEY_PREFIX}${this.userId}_salt`);\r\n      if (salt) {\r\n        this.salt = salt;\r\n      }\r\n      \r\n      // Load metadata\r\n      const metadataJson = this.storage.getItem(`${KEY_META_STORAGE_KEY}_${this.userId}`);\r\n      if (metadataJson) {\r\n        this.metadata = JSON.parse(metadataJson);\r\n      }\r\n      \r\n      // Try to load encryption key from session storage\r\n      if (typeof sessionStorage !== 'undefined') {\r\n        this.encryptionKey = sessionStorage.getItem(ENC_KEY_STORAGE_KEY);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load keys from storage:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Save keys to storage\r\n   */\r\n  private saveKeysToStorage(): void {\r\n    if (!this.storage || !this.userId) return;\r\n    \r\n    try {\r\n      // Save secret key (should ideally be encrypted in a real app)\r\n      if (this.secretKey) {\r\n        this.storage.setItem(`${KEY_PREFIX}${this.userId}`, this.secretKey);\r\n      }\r\n      \r\n      // Save public key (can be stored in clear)\r\n      if (this.publicKey) {\r\n        this.storage.setItem(`${KEY_PREFIX}${this.userId}${PUBLIC_KEY_SUFFIX}`, this.publicKey);\r\n      }\r\n      \r\n      // Save salt\r\n      if (this.salt) {\r\n        this.storage.setItem(`${KEY_PREFIX}${this.userId}_salt`, this.salt);\r\n      }\r\n      \r\n      // Save metadata\r\n      this.saveMetadataToStorage();\r\n    } catch (error) {\r\n      console.error('Failed to save keys to storage:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Save metadata to storage\r\n   */\r\n  private saveMetadataToStorage(): void {\r\n    if (!this.storage || !this.userId || !this.metadata) return;\r\n    \r\n    try {\r\n      this.storage.setItem(\r\n        `${KEY_META_STORAGE_KEY}_${this.userId}`, \r\n        JSON.stringify(this.metadata)\r\n      );\r\n    } catch (error) {\r\n      console.error('Failed to save key metadata to storage:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Get or create a unique device ID\r\n   */\r\n  private getOrCreateDeviceId(): string {\r\n    if (!this.storage) return `device_${Date.now()}`;\r\n    \r\n    const storedDeviceId = this.storage.getItem('moodmash_device_id');\r\n    if (storedDeviceId) {\r\n      return storedDeviceId;\r\n    }\r\n    \r\n    const newDeviceId = `device_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\r\n    this.storage.setItem('moodmash_device_id', newDeviceId);\r\n    return newDeviceId;\r\n  }\r\n  \r\n  /**\r\n   * Get public key for a user from local storage\r\n   * @param userId User ID to get public key for\r\n   */\r\n  public getPublicKeyForUser(userId: string): string | null {\r\n    if (!this.storage) return null;\r\n    \r\n    return this.storage.getItem(`${KEY_PREFIX}${userId}${PUBLIC_KEY_SUFFIX}`);\r\n  }\r\n  \r\n  /**\r\n   * Store a public key for another user\r\n   * @param userId User ID to store public key for\r\n   * @param publicKey Public key to store\r\n   */\r\n  public storePublicKeyForUser(userId: string, publicKey: string): void {\r\n    if (!this.storage) return;\r\n    \r\n    this.storage.setItem(`${KEY_PREFIX}${userId}${PUBLIC_KEY_SUFFIX}`, publicKey);\r\n  }\r\n}\r\n\r\n// Create and export a singleton instance\r\nexport const keyManager = typeof window !== 'undefined' ? new KeyManager() : null; ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\errorHandler.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\hooks\\useEncryptedPreferences.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 69,
        "column": 67,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 69,
        "endColumn": 70,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2310, 2313], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2310, 2313], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 156,
        "column": 71,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 156,
        "endColumn": 74,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [5623, 5626], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [5623, 5626], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'response' is assigned a value but never used.",
        "line": 162,
        "column": 11,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 162,
        "endColumn": 19
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'err' is defined but never used.",
        "line": 203,
        "column": 14,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 203,
        "endColumn": 17
      }
    ],
    "suppressedMessages": [],
    "errorCount": 4,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { useState, useEffect, useCallback } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\nimport { toast } from 'sonner';\r\nimport { api } from '@/lib/api/client';\r\nimport { Preferences } from './usePreferences';\r\nimport { keyManager } from '../encryption/keyManager';\r\nimport { \r\n  encryptPreferences, \r\n  decryptPreferences, \r\n  EncryptedData,\r\n  generateUserKeys\r\n} from '../encryption/crypto';\r\n\r\nexport interface UseEncryptedPreferencesResult {\r\n  preferences: Preferences;\r\n  isLoading: boolean;\r\n  isSaving: boolean;\r\n  isEncrypted: boolean;\r\n  error: Error | null;\r\n  updatePreferences: (newPrefs: Partial<Preferences>) => Promise<void>;\r\n  resetPreferences: () => Promise<void>;\r\n  refetch: () => Promise<void>;\r\n  setupEncryption: (password: string) => Promise<boolean>;\r\n  clearEncryptionKeys: () => void;\r\n}\r\n\r\n// Default preferences\r\nconst defaultPreferences: Preferences = {\r\n  theme: 'system',\r\n  emailNotifications: true,\r\n  pushNotifications: true,\r\n  weeklyDigest: true,\r\n  language: 'en',\r\n  timezone: 'UTC',\r\n};\r\n\r\n/**\r\n * Hook for managing end-to-end encrypted user preferences\r\n */\r\nexport function useEncryptedPreferences(): UseEncryptedPreferencesResult {\r\n  const { data: session, status } = useSession();\r\n  const [preferences, setPreferences] = useState<Preferences>(defaultPreferences);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [isEncrypted, setIsEncrypted] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const [previousPrefs, setPreviousPrefs] = useState<Preferences | null>(null);\r\n\r\n  // Initialize key manager with user ID when session is available\r\n  useEffect(() => {\r\n    if (status === 'authenticated' && session?.user?.id) {\r\n      keyManager?.initialize(session.user.id as string);\r\n    }\r\n  }, [status, session]);\r\n\r\n  // Fetch preferences\r\n  const fetchPreferences = useCallback(async () => {\r\n    if (status !== 'authenticated' || !session) {\r\n      setPreferences(defaultPreferences);\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      // Fetch encrypted or plaintext preferences based on API response\r\n      const response = await api.get<{ encrypted?: boolean; data: any }>('/profile/encrypted-preferences');\r\n      \r\n      if (response.encrypted) {\r\n        setIsEncrypted(true);\r\n        \r\n        // If we have encryption keys, try to decrypt\r\n        const encryptionKey = keyManager?.getEncryptionKey();\r\n        if (encryptionKey) {\r\n          const decrypted = decryptPreferences(response.data as EncryptedData, encryptionKey);\r\n          if (decrypted) {\r\n            setPreferences(decrypted);\r\n          } else {\r\n            // Decryption failed - might need to re-enter password\r\n            toast.error('Could not decrypt preferences', {\r\n              description: 'Please re-enter your password to access your encrypted data',\r\n            });\r\n            setPreferences(defaultPreferences);\r\n          }\r\n        } else {\r\n          // No encryption key available - using defaults\r\n          setPreferences(defaultPreferences);\r\n          toast.info('Encryption key needed', {\r\n            description: 'Please enter your password to decrypt your preferences',\r\n          });\r\n        }\r\n      } else {\r\n        // Not encrypted, just use the data directly\r\n        setIsEncrypted(false);\r\n        setPreferences(response.data || defaultPreferences);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to fetch preferences:', err);\r\n      setError(err instanceof Error ? err : new Error('Failed to load preferences'));\r\n      \r\n      // Show error toast\r\n      toast.error('Failed to load your preferences', {\r\n        description: 'Default settings will be used meanwhile. Please try again later.',\r\n        id: 'preferences-fetch-error',\r\n        dismissible: true,\r\n      });\r\n      \r\n      // Use defaults on error\r\n      setPreferences(defaultPreferences);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [status, session]);\r\n\r\n  // Update preferences with encryption if available\r\n  const updatePreferences = async (newPrefs: Partial<Preferences>) => {\r\n    if (status !== 'authenticated' || !session) {\r\n      toast.error('Authentication required', {\r\n        description: 'You must be logged in to update preferences',\r\n      });\r\n      throw new Error('You must be logged in to update preferences');\r\n    }\r\n\r\n    try {\r\n      // Store current preferences for rollback if needed\r\n      setPreviousPrefs({...preferences});\r\n      \r\n      // Start saving state\r\n      setIsSaving(true);\r\n      setError(null);\r\n      \r\n      // Optimistic update - immediately update UI\r\n      const updatedPrefs = { ...preferences, ...newPrefs };\r\n      setPreferences(updatedPrefs);\r\n      \r\n      // Show unobtrusive saving toast\r\n      const toastId = toast.loading('Saving preferences...');\r\n      \r\n      try {\r\n        let response;\r\n        \r\n        // If we have encryption keys and preferences are encrypted\r\n        if (isEncrypted && keyManager?.hasKeys()) {\r\n          const encryptionKey = keyManager.getEncryptionKey();\r\n          \r\n          if (!encryptionKey) {\r\n            throw new Error('Encryption key not available. Please re-enter your password.');\r\n          }\r\n          \r\n          // Encrypt the updated preferences\r\n          const encryptedData = encryptPreferences(updatedPrefs, encryptionKey);\r\n          \r\n          // Send encrypted data to server\r\n          response = await api.patch<{ success: boolean; preferences: any }>(\r\n            '/profile/encrypted-preferences', \r\n            { encryptedData, encrypted: true }\r\n          );\r\n        } else {\r\n          // Send plaintext preferences if not using encryption\r\n          response = await api.patch<{ preferences: Preferences }>(\r\n            '/profile/preferences', \r\n            newPrefs\r\n          );\r\n        }\r\n        \r\n        // Success toast\r\n        toast.success('Preferences saved', { id: toastId });\r\n        \r\n        // Clear previous state since update was successful\r\n        setPreviousPrefs(null);\r\n      } catch (err) {\r\n        // Error handling for the API call\r\n        console.error('Failed to update preferences:', err);\r\n        setError(err instanceof Error ? err : new Error('Failed to update preferences'));\r\n        \r\n        // Rollback to previous state\r\n        if (previousPrefs) {\r\n          setPreferences(previousPrefs);\r\n        }\r\n        \r\n        // Error toast\r\n        toast.error('Failed to save preferences', { \r\n          id: toastId,\r\n          description: 'Your changes will be restored when you refresh the page.'\r\n        });\r\n        \r\n        // Rethrow to let calling component handle the error\r\n        throw err;\r\n      }\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  // Reset preferences to defaults\r\n  const resetPreferences = async () => {\r\n    toast.info('Resetting preferences to defaults...');\r\n    try {\r\n      await updatePreferences(defaultPreferences);\r\n      toast.success('Preferences reset to defaults');\r\n    } catch (err) {\r\n      // Error is already handled in updatePreferences\r\n    }\r\n  };\r\n  \r\n  // Set up encryption for preferences\r\n  const setupEncryption = async (password: string): Promise<boolean> => {\r\n    if (!session?.user?.id || !password) {\r\n      toast.error('Cannot set up encryption', {\r\n        description: 'User ID and password are required',\r\n      });\r\n      return false;\r\n    }\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      \r\n      // Generate user keys from password\r\n      const userId = session.user.id as string;\r\n      const email = session.user.email || `user-${userId}@example.com`;\r\n      const keys = await generateUserKeys(email, password);\r\n      \r\n      // Store the keys in key manager\r\n      keyManager?.initialize(userId);\r\n      keyManager?.setKeys(keys);\r\n      \r\n      // Set the encryption key from password\r\n      await keyManager?.setEncryptionKeyFromPassword(password);\r\n      \r\n      // Get the encryption key\r\n      const encryptionKey = keyManager?.getEncryptionKey();\r\n      if (!encryptionKey) {\r\n        throw new Error('Failed to set encryption key');\r\n      }\r\n      \r\n      // Encrypt current preferences\r\n      const encryptedData = encryptPreferences(preferences, encryptionKey);\r\n      \r\n      // Upload public key and encrypted preferences\r\n      await api.post('/profile/setup-encryption', {\r\n        publicKey: keys.publicKey,\r\n        salt: keys.salt,\r\n        encryptedPreferences: encryptedData\r\n      });\r\n      \r\n      setIsEncrypted(true);\r\n      \r\n      toast.success('End-to-end encryption set up successfully', {\r\n        description: 'Your preferences are now encrypted',\r\n      });\r\n      \r\n      // Refetch to confirm\r\n      await fetchPreferences();\r\n      \r\n      return true;\r\n    } catch (error) {\r\n      console.error('Failed to set up encryption:', error);\r\n      toast.error('Failed to set up encryption', {\r\n        description: error instanceof Error ? error.message : 'Please try again later',\r\n      });\r\n      return false;\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  \r\n  // Clear encryption keys (e.g., on logout)\r\n  const clearEncryptionKeys = useCallback(() => {\r\n    keyManager?.clearKeys();\r\n    setIsEncrypted(false);\r\n  }, []);\r\n\r\n  // Load preferences on mount and when session changes\r\n  useEffect(() => {\r\n    fetchPreferences();\r\n  }, [fetchPreferences]);\r\n\r\n  return {\r\n    preferences,\r\n    isLoading,\r\n    isSaving,\r\n    isEncrypted,\r\n    error,\r\n    updatePreferences,\r\n    resetPreferences,\r\n    refetch: fetchPreferences,\r\n    setupEncryption,\r\n    clearEncryptionKeys,\r\n  };\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\hooks\\useFetch.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'FetcherFn' is defined but never used.",
        "line": 5,
        "column": 6,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 5,
        "endColumn": 15
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 27,
        "column": 33,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 27,
        "endColumn": 36,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [923, 926], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [923, 926], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 27,
        "column": 46,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 27,
        "endColumn": 49,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [936, 939], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [936, 939], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 47,
        "column": 72,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 47,
        "endColumn": 75,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1370, 1373], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1370, 1373], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 47,
        "column": 89,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 47,
        "endColumn": 92,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1387, 1390], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1387, 1390], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 83,
        "column": 69,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 83,
        "endColumn": 72,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2243, 2246], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2243, 2246], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 83,
        "column": 86,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 83,
        "endColumn": 89,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2260, 2263], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2260, 2263], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 105,
        "column": 36,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 105,
        "endColumn": 39,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2887, 2890], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2887, 2890], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 105,
        "column": 49,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 105,
        "endColumn": 52,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2900, 2903], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2900, 2903], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 105,
        "column": 69,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 105,
        "endColumn": 72,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2920, 2923], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2920, 2923], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 10,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { useState, useCallback } from 'react';\r\nimport useSWR, { SWRConfiguration, SWRResponse, mutate as swrMutate } from 'swr';\r\nimport { api } from '@/lib/api/client';\r\n\r\ntype FetcherFn<Data> = (url: string) => Promise<Data>;\r\n\r\n// Global configuration for SWR\r\nexport const DEFAULT_SWR_CONFIG: SWRConfiguration = {\r\n  revalidateOnFocus: false,  // Don't revalidate when window focuses\r\n  revalidateOnReconnect: true, // Revalidate when browser regains connection\r\n  refreshWhenOffline: false, // Don't refresh when offline\r\n  shouldRetryOnError: true,\r\n  errorRetryCount: 3,\r\n  dedupingInterval: 2000, // Dedupe requests with same key in this time span\r\n};\r\n\r\n/**\r\n * Enhanced SWR fetcher function with our API client\r\n */\r\nexport function fetcher<T>(url: string): Promise<T> {\r\n  return api.get<T>(url);\r\n}\r\n\r\n/**\r\n * Enhanced useFetch hook with SWR for data fetching and caching\r\n */\r\nexport function useFetch<Data = any, Error = any>(\r\n  url: string | null,\r\n  config: SWRConfiguration = {}\r\n): SWRResponse<Data, Error> {\r\n  // Only fetch if we have a URL\r\n  const finalUrl = url || null;\r\n  \r\n  return useSWR<Data, Error>(\r\n    finalUrl,\r\n    finalUrl ? fetcher : null,\r\n    {\r\n      ...DEFAULT_SWR_CONFIG,\r\n      ...config,\r\n    }\r\n  );\r\n}\r\n\r\n/**\r\n * Hook for paginated data fetching\r\n */\r\nexport function usePaginatedFetch<Data extends { total: number; items: any[] }, Error = any>(\r\n  baseUrl: string,\r\n  page: number = 1,\r\n  pageSize: number = 10,\r\n  config: SWRConfiguration = {}\r\n) {\r\n  const url = baseUrl ? `${baseUrl}?page=${page}&pageSize=${pageSize}` : null;\r\n  \r\n  const result = useFetch<Data, Error>(url, config);\r\n  \r\n  // Calculate pagination details\r\n  const pagination = result.data\r\n    ? {\r\n        currentPage: page,\r\n        pageSize,\r\n        totalItems: result.data.total,\r\n        totalPages: Math.ceil(result.data.total / pageSize),\r\n        hasMore: page * pageSize < result.data.total,\r\n      }\r\n    : {\r\n        currentPage: page,\r\n        pageSize,\r\n        totalItems: 0,\r\n        totalPages: 0,\r\n        hasMore: false,\r\n      };\r\n  \r\n  return {\r\n    ...result,\r\n    pagination,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for search data fetching\r\n */\r\nexport function useSearchFetch<Data extends { total: number; items: any[] }, Error = any>(\r\n  baseUrl: string,\r\n  query: string,\r\n  page: number = 1,\r\n  pageSize: number = 10,\r\n  config: SWRConfiguration = {}\r\n) {\r\n  // Only search if we have a non-empty query\r\n  const url = query && baseUrl \r\n    ? `${baseUrl}?query=${encodeURIComponent(query)}&page=${page}&pageSize=${pageSize}` \r\n    : null;\r\n  \r\n  return usePaginatedFetch<Data, Error>(url || '', page, pageSize, {\r\n    ...config,\r\n    // Dedupe requests with same search term more aggressively\r\n    dedupingInterval: 500,\r\n  });\r\n}\r\n\r\n/**\r\n * Enhanced hook for creating a mutation function with optimistic updates\r\n */\r\nexport function useMutation<Data = any, Input = any, RollbackData = any>(\r\n  url: string,\r\n  method: 'POST' | 'PUT' | 'PATCH' | 'DELETE' = 'POST',\r\n  options: {\r\n    // Keys to invalidate on success\r\n    invalidateKeys?: string[];\r\n    // Function to calculate optimistic data from input\r\n    optimisticUpdate?: (input: Input) => RollbackData;\r\n    // Function to revert optimistic update on error\r\n    rollbackOnError?: boolean;\r\n    // Whether to show toast notifications\r\n    showToasts?: boolean;\r\n    // Messages for toast notifications\r\n    messages?: {\r\n      loading?: string;\r\n      success?: string;\r\n      error?: string;\r\n    };\r\n  } = {}\r\n): [(input: Input) => Promise<Data>, { \r\n  isLoading: boolean; \r\n  error: Error | null;\r\n  reset: () => void;\r\n}] {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  \r\n  // Default options\r\n  const {\r\n    invalidateKeys = [url],\r\n    optimisticUpdate,\r\n    rollbackOnError = true,\r\n    showToasts = false,\r\n    messages = {\r\n      loading: 'Processing request...',\r\n      success: 'Request completed successfully',\r\n      error: 'Failed to complete request'\r\n    }\r\n  } = options;\r\n  \r\n  // Reset the error state\r\n  const reset = useCallback(() => {\r\n    setError(null);\r\n  }, []);\r\n  \r\n  // Mutation function\r\n  const mutation = async (input: Input): Promise<Data> => {\r\n    let rollbackData: RollbackData | undefined;\r\n    let toastId: string | undefined;\r\n    \r\n    setIsLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      // Show loading toast if enabled\r\n      if (showToasts) {\r\n        toastId = Math.random().toString(36).substring(2, 9);\r\n        const { toast } = await import('sonner');\r\n        toast.loading(messages.loading || 'Processing...', { id: toastId });\r\n      }\r\n      \r\n      // Apply optimistic update if provided\r\n      if (optimisticUpdate) {\r\n        rollbackData = optimisticUpdate(input);\r\n      }\r\n      \r\n      // Execute the API call based on method\r\n      let result: Data;\r\n      switch (method) {\r\n        case 'POST':\r\n          result = await api.post<Data>(url, input);\r\n          break;\r\n        case 'PUT':\r\n          result = await api.put<Data>(url, input);\r\n          break;\r\n        case 'PATCH':\r\n          result = await api.patch<Data>(url, input);\r\n          break;\r\n        case 'DELETE':\r\n          result = await api.delete<Data>(url);\r\n          break;\r\n        default:\r\n          result = await api.post<Data>(url, input);\r\n      }\r\n      \r\n      // Invalidate related caches\r\n      for (const key of invalidateKeys) {\r\n        await swrMutate(key);\r\n      }\r\n      \r\n      // Show success toast\r\n      if (showToasts && toastId) {\r\n        const { toast } = await import('sonner');\r\n        toast.success(messages.success || 'Success', { id: toastId });\r\n      }\r\n      \r\n      return result;\r\n    } catch (err) {\r\n      console.error(`Mutation error (${url}):`, err);\r\n      const errorObj = err instanceof Error ? err : new Error(messages.error || 'An error occurred');\r\n      setError(errorObj);\r\n      \r\n      // Show error toast\r\n      if (showToasts && toastId) {\r\n        const { toast } = await import('sonner');\r\n        toast.error(messages.error || 'An error occurred', { \r\n          id: toastId,\r\n          description: errorObj.message\r\n        });\r\n      }\r\n      \r\n      // Apply rollback if we did an optimistic update\r\n      if (rollbackOnError && rollbackData !== undefined) {\r\n        // Here you would restore the previous state\r\n        // This is application-specific and depends on your caching strategy\r\n        // Example for SWR:\r\n        for (const key of invalidateKeys) {\r\n          await swrMutate(key, rollbackData, false);\r\n        }\r\n      }\r\n      \r\n      throw errorObj;\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  \r\n  return [mutation, { isLoading, error, reset }];\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\hooks\\usePreferences.ts",
    "messages": [
      {
        "ruleId": "react-hooks/exhaustive-deps",
        "severity": 1,
        "message": "React Hook useCallback has a missing dependency: 'defaultPreferences'. Either include it or remove the dependency array.",
        "line": 76,
        "column": 6,
        "nodeType": "ArrayExpression",
        "endLine": 76,
        "endColumn": 23,
        "suggestions": [
          {
            "desc": "Update the dependencies array to be: [status, session, defaultPreferences]",
            "fix": { "range": [2447, 2464], "text": "[status, session, defaultPreferences]" }
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'err' is defined but never used.",
        "line": 144,
        "column": 14,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 144,
        "endColumn": 17
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { useState, useEffect, useCallback } from 'react';\r\nimport { api } from '@/lib/api/client';\r\nimport { useSession } from 'next-auth/react';\r\nimport { toast } from 'sonner';\r\n\r\nexport interface Preferences {\r\n  theme?: 'light' | 'dark' | 'system';\r\n  emailNotifications?: boolean;\r\n  pushNotifications?: boolean;\r\n  weeklyDigest?: boolean;\r\n  language?: string;\r\n  timezone?: string;\r\n}\r\n\r\ninterface UsePreferencesResult {\r\n  preferences: Preferences;\r\n  isLoading: boolean;\r\n  isSaving: boolean;\r\n  error: Error | null;\r\n  updatePreferences: (newPrefs: Partial<Preferences>) => Promise<void>;\r\n  resetPreferences: () => Promise<void>;\r\n  refetch: () => Promise<void>;\r\n}\r\n\r\n/**\r\n * Enhanced hook for managing user preferences with optimistic updates and error handling\r\n */\r\nexport function usePreferences(): UsePreferencesResult {\r\n  const { data: session, status } = useSession();\r\n  const [preferences, setPreferences] = useState<Preferences>({});\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const [previousPrefs, setPreviousPrefs] = useState<Preferences | null>(null);\r\n\r\n  // Default preferences\r\n  const defaultPreferences: Preferences = {\r\n    theme: 'system',\r\n    emailNotifications: true,\r\n    pushNotifications: true,\r\n    weeklyDigest: true,\r\n    language: 'en',\r\n    timezone: 'UTC',\r\n  };\r\n\r\n  // Fetch preferences with improved error handling\r\n  const fetchPreferences = useCallback(async () => {\r\n    if (status !== 'authenticated' || !session) {\r\n      setPreferences(defaultPreferences);\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      const data = await api.get<Preferences>('/profile/preferences');\r\n      setPreferences(data || defaultPreferences);\r\n    } catch (err) {\r\n      console.error('Failed to fetch preferences:', err);\r\n      setError(err instanceof Error ? err : new Error('Failed to load preferences'));\r\n      \r\n      // Show error toast\r\n      toast.error('Failed to load your preferences', {\r\n        description: 'Default settings will be used meanwhile. Please try again later.',\r\n        id: 'preferences-fetch-error',\r\n        dismissible: true,\r\n      });\r\n      \r\n      // Use defaults on error\r\n      setPreferences(defaultPreferences);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [status, session]);\r\n\r\n  // Update preferences with optimistic updates and error handling\r\n  const updatePreferences = async (newPrefs: Partial<Preferences>) => {\r\n    if (status !== 'authenticated' || !session) {\r\n      toast.error('Authentication required', {\r\n        description: 'You must be logged in to update preferences',\r\n      });\r\n      throw new Error('You must be logged in to update preferences');\r\n    }\r\n\r\n    try {\r\n      // Store current preferences for rollback if needed\r\n      setPreviousPrefs({...preferences});\r\n      \r\n      // Start saving state\r\n      setIsSaving(true);\r\n      setError(null);\r\n      \r\n      // Optimistic update - immediately update UI\r\n      const updatedPrefs = { ...preferences, ...newPrefs };\r\n      setPreferences(updatedPrefs);\r\n      \r\n      // Show unobtrusive saving toast\r\n      const toastId = toast.loading('Saving preferences...');\r\n      \r\n      try {\r\n        // Send update to server\r\n        const response = await api.patch<{ preferences: Preferences }>('/profile/preferences', newPrefs);\r\n        \r\n        // Update with server response to ensure accuracy\r\n        setPreferences(response.preferences);\r\n        \r\n        // Success toast\r\n        toast.success('Preferences saved', { id: toastId });\r\n        \r\n        // Clear previous state since update was successful\r\n        setPreviousPrefs(null);\r\n      } catch (err) {\r\n        // Error handling for the API call\r\n        console.error('Failed to update preferences:', err);\r\n        setError(err instanceof Error ? err : new Error('Failed to update preferences'));\r\n        \r\n        // Rollback to previous state\r\n        if (previousPrefs) {\r\n          setPreferences(previousPrefs);\r\n        }\r\n        \r\n        // Error toast\r\n        toast.error('Failed to save preferences', { \r\n          id: toastId,\r\n          description: 'Your changes will be restored when you refresh the page.'\r\n        });\r\n        \r\n        // Rethrow to let calling component handle the error\r\n        throw err;\r\n      }\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  // Reset preferences to defaults with feedback\r\n  const resetPreferences = async () => {\r\n    toast.info('Resetting preferences to defaults...');\r\n    try {\r\n      await updatePreferences(defaultPreferences);\r\n      toast.success('Preferences reset to defaults');\r\n    } catch (err) {\r\n      // Error is already handled in updatePreferences\r\n    }\r\n  };\r\n\r\n  // Load preferences on mount and when session changes\r\n  useEffect(() => {\r\n    fetchPreferences();\r\n  }, [fetchPreferences]);\r\n\r\n  return {\r\n    preferences,\r\n    isLoading,\r\n    isSaving,\r\n    error,\r\n    updatePreferences,\r\n    resetPreferences,\r\n    refetch: fetchPreferences,\r\n  };\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\patched-next-auth.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-require-imports",
        "severity": 2,
        "message": "A `require()` style import is forbidden.",
        "line": 14,
        "column": 16,
        "nodeType": "CallExpression",
        "messageId": "noRequireImports",
        "endLine": 14,
        "endColumn": 29
      },
      {
        "ruleId": "@typescript-eslint/no-require-imports",
        "severity": 2,
        "message": "A `require()` style import is forbidden.",
        "line": 15,
        "column": 18,
        "nodeType": "CallExpression",
        "messageId": "noRequireImports",
        "endLine": 15,
        "endColumn": 33
      }
    ],
    "suppressedMessages": [],
    "errorCount": 2,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "/**\r\n * This file contains patched exports from next-auth to work around compatibility issues.\r\n */\r\n\r\n// Re-export from next-auth\r\nexport * from 'next-auth';\r\nexport { default } from 'next-auth';\r\n\r\n// Fix the server-side import issues\r\nif (typeof window === 'undefined') {\r\n  // This is server-side, so we'll have access to the NextAuth internals\r\n  try {\r\n    const nextAuthPath = require.resolve('next-auth');\r\n    const fs = require('fs');\r\n    const path = require('path');\r\n    \r\n    // Path to the env.js file that's causing issues\r\n    const envPath = path.join(path.dirname(nextAuthPath), 'lib', 'env.js');\r\n    \r\n    // Check if the file exists and hasn't been patched yet\r\n    if (fs.existsSync(envPath)) {\r\n      let content = fs.readFileSync(envPath, 'utf8');\r\n      \r\n      // Only patch if it has the problematic import\r\n      if (content.includes('next/server')) {\r\n        console.log('Patching next-auth server import...');\r\n        // Replace the problematic import with the correct one\r\n        content = content.replace(\r\n          `import { cookies } from \"next/server\"`,\r\n          `import { cookies } from \"next/headers\"`\r\n        );\r\n        \r\n        // Write the patched file\r\n        fs.writeFileSync(envPath, content, 'utf8');\r\n        console.log('next-auth server import patched successfully!');\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.error('Error patching next-auth:', error);\r\n  }\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\prisma.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\providers\\query-provider.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\providers\\root-provider.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\providers\\theme-provider.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\seo\\schema.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\swagger.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\utils.test.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\lib\\utils.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\_app.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\_document.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\_error.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\account\\security.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\account\\settings.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api-docs.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 16,
        "column": 24,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 16,
        "endColumn": 27,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [421, 424], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [421, 424], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { GetStaticProps } from 'next';\r\nimport dynamic from 'next/dynamic';\r\nimport { getSwaggerSpec } from '@/lib/swagger';\r\nimport Head from 'next/head';\r\n\r\n// Import SwaggerUI dynamically to avoid SSR issues\r\nconst SwaggerUI = dynamic(\r\n  () => import('swagger-ui-react'),\r\n  { ssr: false }\r\n);\r\n\r\n// Import swagger styles\r\nimport 'swagger-ui-react/swagger-ui.css';\r\n\r\ninterface ApiDocsProps {\r\n  spec: Record<string, any>;\r\n}\r\n\r\nexport default function ApiDocs({ spec }: ApiDocsProps) {\r\n  return (\r\n    <>\r\n      <Head>\r\n        <title>MoodMash API Documentation</title>\r\n        <meta name=\"description\" content=\"API documentation for MoodMash\" />\r\n      </Head>\r\n      \r\n      <div className=\"api-docs-container\">\r\n        <div className=\"api-docs-header\">\r\n          <h1>MoodMash API Documentation</h1>\r\n          <p>Explore and test the MoodMash API endpoints</p>\r\n        </div>\r\n        <SwaggerUI spec={spec} />\r\n      </div>\r\n      \r\n      <style jsx>{`\r\n        .api-docs-container {\r\n          padding: 2rem;\r\n        }\r\n        \r\n        .api-docs-header {\r\n          margin-bottom: 2rem;\r\n          padding-bottom: 1rem;\r\n          border-bottom: 1px solid #eaeaea;\r\n        }\r\n        \r\n        .api-docs-header h1 {\r\n          font-size: 2rem;\r\n          font-weight: bold;\r\n          margin-bottom: 0.5rem;\r\n        }\r\n        \r\n        .api-docs-header p {\r\n          color: #666;\r\n        }\r\n        \r\n        :global(.swagger-ui) {\r\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\r\n            Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\r\n            sans-serif;\r\n        }\r\n      `}</style>\r\n    </>\r\n  );\r\n}\r\n\r\nexport const getStaticProps: GetStaticProps = async () => {\r\n  const spec = getSwaggerSpec();\r\n  \r\n  return {\r\n    props: {\r\n      spec,\r\n    },\r\n  };\r\n}; ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\account\\settings\\appearance.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\account\\settings\\index.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\account\\settings\\notifications.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\[...nextauth].ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\forgot-password.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\mfa\\challenge.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\mfa\\disable.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\mfa\\setup.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\mfa\\validate.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\mfa\\verify.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\register\\index.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\reset-password.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\validate-reset-token.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\verify-email.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\webauthn\\credentials\\[id].ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\webauthn\\credentials\\index.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\webauthn\\login-options.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\webauthn\\login-verify.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'db' is defined but never used.",
        "line": 5,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 5,
        "endColumn": 12
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import type { NextApiRequest, NextApiResponse } from 'next';\r\nimport { verifyWebAuthnAuthentication } from '@/lib/auth/webauthn';\r\nimport { authenticationChallengeStore } from './login-options';\r\nimport { rateLimit, resetRateLimit } from '@/lib/auth/rate-limit';\r\nimport { db } from '@/lib/db/prisma';\r\nimport { getServerSession } from 'next-auth';\r\nimport { authConfig } from '@/lib/auth/auth.config';\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n  if (req.method !== 'POST') {\r\n    return res.status(405).json({ message: 'Method not allowed' });\r\n  }\r\n\r\n  // Apply rate limiting\r\n  const rateLimitPassed = await rateLimit(req, res, 'general');\r\n  if (!rateLimitPassed) return;\r\n\r\n  try {\r\n    const { credential, requestId } = req.body;\r\n\r\n    if (!credential || !requestId) {\r\n      return res.status(400).json({ message: 'Credential and requestId are required' });\r\n    }\r\n\r\n    // Get the challenge from the store\r\n    const expectedChallenge = authenticationChallengeStore[requestId];\r\n    if (!expectedChallenge) {\r\n      return res.status(400).json({ \r\n        message: 'Authentication challenge not found or expired. Please try again.' \r\n      });\r\n    }\r\n\r\n    // Verify the authentication\r\n    const verification = await verifyWebAuthnAuthentication(\r\n      credential,\r\n      expectedChallenge,\r\n    );\r\n\r\n    // Remove the challenge from the store\r\n    delete authenticationChallengeStore[requestId];\r\n\r\n    if (!verification.verified || !verification.user) {\r\n      return res.status(400).json({ message: 'Authentication failed' });\r\n    }\r\n\r\n    // Reset login rate limit for this user\r\n    if (verification.user.email) {\r\n      await resetRateLimit('login', verification.user.email);\r\n    }\r\n\r\n    // Create a custom JWT token for the user\r\n    const session = await getServerSession(req, res, authConfig);\r\n    \r\n    if (!session) {\r\n      // If no session exists, return the user info for client-side sign-in\r\n      return res.status(200).json({\r\n        message: 'Authentication successful',\r\n        user: {\r\n          id: verification.user.id,\r\n          email: verification.user.email,\r\n        },\r\n      });\r\n    }\r\n\r\n    // If a session already exists, update it\r\n    return res.status(200).json({\r\n      message: 'Authentication successful',\r\n      user: {\r\n        id: verification.user.id,\r\n        email: verification.user.email,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    console.error('WebAuthn authentication verification error:', error);\r\n    return res.status(500).json({ message: 'Internal server error' });\r\n  }\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\webauthn\\register-options.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\auth\\webauthn\\register-verify.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\dashboard\\stats.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 117,
        "column": 35,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 117,
        "endColumn": 38,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3864, 3867], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3864, 3867], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { createApiHandler, ApiError } from '@/lib/api/handlers';\r\nimport { db } from '@/lib/db/prisma';\r\nimport { z } from 'zod';\r\n\r\n/**\r\n * @swagger\r\n * /api/dashboard/stats:\r\n *   get:\r\n *     tags: [Dashboard]\r\n *     summary: Get user dashboard statistics\r\n *     description: Retrieves user-specific dashboard statistics including mood count, likes received, comments received, and recent activity\r\n *     security:\r\n *       - cookieAuth: []\r\n *     responses:\r\n *       200:\r\n *         description: Dashboard statistics\r\n *         content:\r\n *           application/json:\r\n *             schema:\r\n *               type: object\r\n *               properties:\r\n *                 moodCount:\r\n *                   type: integer\r\n *                   description: Total number of moods created by the user\r\n *                   example: 25\r\n *                 likesReceived:\r\n *                   type: integer\r\n *                   description: Total number of likes received on user's moods\r\n *                   example: 42\r\n *                 commentsReceived:\r\n *                   type: integer\r\n *                   description: Total number of comments received on user's moods\r\n *                   example: 15\r\n *                 recentActivity:\r\n *                   type: array\r\n *                   description: List of recent mood activities\r\n *                   items:\r\n *                     $ref: '#/components/schemas/MoodActivity'\r\n *                 lastUpdated:\r\n *                   type: string\r\n *                   format: date-time\r\n *                   description: Timestamp of when the stats were generated\r\n *                   example: '2023-01-01T12:00:00.000Z'\r\n *       401:\r\n *         description: Unauthorized - User is not authenticated\r\n *       500:\r\n *         description: Server error\r\n */\r\n\r\n/**\r\n * @swagger\r\n * components:\r\n *   schemas:\r\n *     MoodActivity:\r\n *       type: object\r\n *       properties:\r\n *         id:\r\n *           type: string\r\n *           description: Unique ID of the mood\r\n *           example: 'clq123abc456'\r\n *         emoji:\r\n *           type: string\r\n *           nullable: true\r\n *           description: Emoji representing the mood\r\n *           example: 'ðŸ˜€'\r\n *         text:\r\n *           type: string\r\n *           nullable: true\r\n *           description: Text content of the mood\r\n *           example: 'Feeling great today!'\r\n *         colors:\r\n *           type: array\r\n *           description: Gradient colors of the mood\r\n *           items:\r\n *             type: string\r\n *             example: '#FF5733'\r\n *         createdAt:\r\n *           type: string\r\n *           format: date-time\r\n *           description: When the mood was created\r\n *           example: '2023-01-01T10:30:00.000Z'\r\n *         likes:\r\n *           type: integer\r\n *           description: Number of likes on this mood\r\n *           example: 5\r\n *         comments:\r\n *           type: integer\r\n *           description: Number of comments on this mood\r\n *           example: 2\r\n */\r\n\r\n// Define the schema for dashboard stats response\r\nconst statsResponseSchema = z.object({\r\n  moodCount: z.number().int().nonnegative(),\r\n  likesReceived: z.number().int().nonnegative(),\r\n  commentsReceived: z.number().int().nonnegative(),\r\n  recentActivity: z.array(\r\n    z.object({\r\n      id: z.string(),\r\n      emoji: z.string().nullable(),\r\n      text: z.string().nullable(),\r\n      colors: z.array(z.string()),\r\n      createdAt: z.string(),\r\n      likes: z.number().int().nonnegative(),\r\n      comments: z.number().int().nonnegative(),\r\n    })\r\n  ),\r\n  lastUpdated: z.string(),\r\n});\r\n\r\n// Type definition based on the schema\r\ntype StatsResponse = z.infer<typeof statsResponseSchema>;\r\n\r\n/**\r\n * Format recent activity data from database to a consistent structure\r\n */\r\nfunction formatActivity(activity: any[]): StatsResponse['recentActivity'] {\r\n  return activity.map(mood => ({\r\n    id: mood.id,\r\n    emoji: mood.emoji,\r\n    text: mood.text,\r\n    colors: mood.gradientColors,\r\n    createdAt: mood.createdAt.toISOString(),\r\n    likes: mood._count.moodLikes,\r\n    comments: mood._count.moodComments,\r\n  }));\r\n}\r\n\r\nexport default createApiHandler(\r\n  {\r\n    methods: ['GET'],\r\n    requireAuth: true,\r\n    rateLimitType: 'general',\r\n  },\r\n  async (req, res, { userId }) => {\r\n    try {\r\n      // Ensure userId is a string\r\n      if (!userId) {\r\n        throw ApiError.unauthorized('User ID is required');\r\n      }\r\n      \r\n      // Use a transaction to ensure data consistency across queries\r\n      const [moodCount, likesReceived, commentsReceived, recentActivity] = await db.$transaction([\r\n        // Get mood count\r\n        db.mood.count({\r\n          where: { userId },\r\n        }),\r\n        \r\n        // Get likes received\r\n        db.moodLike.count({\r\n          where: {\r\n            mood: {\r\n              userId,\r\n            },\r\n          },\r\n        }),\r\n        \r\n        // Get comments received\r\n        db.moodComment.count({\r\n          where: {\r\n            mood: {\r\n              userId,\r\n            },\r\n          },\r\n        }),\r\n        \r\n        // Get recent activity with a single query\r\n        db.mood.findMany({\r\n          where: { userId },\r\n          orderBy: { createdAt: 'desc' },\r\n          take: 5,\r\n          select: {\r\n            id: true,\r\n            emoji: true,\r\n            text: true,\r\n            createdAt: true,\r\n            gradientColors: true,\r\n            _count: {\r\n              select: {\r\n                moodLikes: true,\r\n                moodComments: true,\r\n              },\r\n            },\r\n          },\r\n        }),\r\n      ]);\r\n      \r\n      // Format the data\r\n      const formattedActivity = formatActivity(recentActivity);\r\n      \r\n      // Create the response object\r\n      const statsData: StatsResponse = {\r\n        moodCount,\r\n        likesReceived,\r\n        commentsReceived,\r\n        recentActivity: formattedActivity,\r\n        lastUpdated: new Date().toISOString(),\r\n      };\r\n      \r\n      // Validate the response against our schema\r\n      try {\r\n        statsResponseSchema.parse(statsData);\r\n      } catch (validationError) {\r\n        console.error('Invalid stats data structure:', validationError);\r\n        // If validation fails, we still return the data but log the error\r\n        // This helps catch bugs in our formatting logic\r\n      }\r\n      \r\n      // Return all stats\r\n      return res.status(200).json(statsData);\r\n    } catch (error: unknown) {\r\n      console.error('Error fetching dashboard stats:', error);\r\n      \r\n      if (error instanceof ApiError) {\r\n        return res.status(error.statusCode).json({ message: error.message });\r\n      }\r\n      \r\n      // Handle database errors - check for Prisma-specific error structure\r\n      const prismaError = error as { code?: string };\r\n      if (prismaError.code && typeof prismaError.code === 'string' && prismaError.code.startsWith('P')) {\r\n        // Prisma error codes start with P\r\n        return res.status(500).json({ \r\n          message: 'Database error',\r\n          code: prismaError.code \r\n        });\r\n      }\r\n      \r\n      return res.status(500).json({ message: 'Internal server error' });\r\n    }\r\n  }\r\n); ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\health.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\hello.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\messages\\secure.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'getServerSession' is defined but never used.",
        "line": 2,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 2,
        "endColumn": 26
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'authOptions' is defined but never used.",
        "line": 3,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 3,
        "endColumn": 21
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'EncryptedMessage' is defined but never used.",
        "line": 6,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 6,
        "endColumn": 26
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'Prisma' is defined but never used.",
        "line": 8,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 8,
        "endColumn": 16
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'EncryptedData' is defined but never used.",
        "line": 9,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 9,
        "endColumn": 23
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 176,
        "column": 29,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 176,
        "endColumn": 32,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [5477, 5480], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [5477, 5480], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 6,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { NextApiRequest, NextApiResponse } from 'next';\r\nimport { getServerSession } from 'next-auth/next';\r\nimport { authOptions } from '@/lib/auth/auth-options';\r\nimport { createApiHandler } from '@/lib/api/handlers';\r\nimport { prisma } from '@/lib/prisma';\r\nimport { EncryptedMessage } from '@/lib/encryption/crypto';\r\nimport { Session } from 'next-auth';\r\nimport { Prisma } from '@prisma/client';\r\nimport { EncryptedData } from '@/lib/encryption/crypto';\r\n\r\n// Define interface to match ApiContext\r\ninterface ApiContext {\r\n  session: Session | null;\r\n  userId: string | null;\r\n}\r\n\r\n/**\r\n * @swagger\r\n * /api/messages/secure:\r\n *   post:\r\n *     summary: Send encrypted message\r\n *     description: Sends an encrypted message to another user\r\n *     tags:\r\n *       - Messages\r\n *     requestBody:\r\n *       required: true\r\n *       content:\r\n *         application/json:\r\n *           schema:\r\n *             type: object\r\n *             required:\r\n *               - recipientId\r\n *               - ciphertext\r\n *               - nonce\r\n *               - senderPublicKey\r\n *             properties:\r\n *               recipientId:\r\n *                 type: string\r\n *                 description: The recipient's user ID\r\n *               ciphertext:\r\n *                 type: string\r\n *                 description: The encrypted message content\r\n *               nonce:\r\n *                 type: string\r\n *                 description: The nonce used for encryption\r\n *               senderPublicKey:\r\n *                 type: string\r\n *                 description: The sender's public key\r\n *               metadata:\r\n *                 type: string\r\n *                 description: Optional metadata for the message\r\n *     responses:\r\n *       201:\r\n *         description: Message sent successfully\r\n *       400:\r\n *         description: Invalid request body\r\n *       401:\r\n *         description: Unauthorized\r\n *       500:\r\n *         description: Server error\r\n *   get:\r\n *     summary: Get encrypted messages\r\n *     description: Retrieves encrypted messages for the authenticated user\r\n *     tags:\r\n *       - Messages\r\n *     parameters:\r\n *       - in: query\r\n *         name: limit\r\n *         schema:\r\n *           type: integer\r\n *           default: 20\r\n *         description: Maximum number of messages to return\r\n *       - in: query\r\n *         name: offset\r\n *         schema:\r\n *           type: integer\r\n *           default: 0\r\n *         description: Number of messages to skip\r\n *       - in: query\r\n *         name: partnerId\r\n *         schema:\r\n *           type: string\r\n *         description: Filter messages to/from a specific user\r\n *     responses:\r\n *       200:\r\n *         description: Retrieved messages successfully\r\n *       401:\r\n *         description: Unauthorized\r\n *       500:\r\n *         description: Server error\r\n */\r\n\r\n// Handler for sending and receiving encrypted messages\r\nconst handler = async (req: NextApiRequest, res: NextApiResponse, context: ApiContext) => {\r\n  const { userId } = context;\r\n\r\n  if (!userId) {\r\n    return res.status(401).json({\r\n      error: 'Unauthorized',\r\n      message: 'You must be logged in to perform this action'\r\n    });\r\n  }\r\n\r\n  if (req.method === 'POST') {\r\n    // Parse request body\r\n    const { recipientId, ciphertext, nonce, senderPublicKey, metadata } = req.body;\r\n\r\n    if (!recipientId || !ciphertext || !nonce || !senderPublicKey) {\r\n      return res.status(400).json({\r\n        error: 'Bad Request',\r\n        message: 'Missing required fields'\r\n      });\r\n    }\r\n\r\n    try {\r\n      // Verify recipient exists\r\n      const recipient = await prisma.user.findUnique({\r\n        where: { id: recipientId }\r\n      });\r\n\r\n      if (!recipient) {\r\n        return res.status(404).json({\r\n          error: 'Not Found',\r\n          message: 'Recipient not found'\r\n        });\r\n      }\r\n\r\n      // Get recipient public key to verify they have encryption set up\r\n      const recipientPublicKey = await prisma.encryptionKey.findFirst({\r\n        where: { userId: recipientId }\r\n      });\r\n\r\n      if (!recipientPublicKey) {\r\n        return res.status(400).json({\r\n          error: 'Bad Request',\r\n          message: 'Recipient has not set up encryption'\r\n        });\r\n      }\r\n\r\n      // Store encrypted message\r\n      const message = await prisma.encryptedMessage.create({\r\n        data: {\r\n          sender: { connect: { id: userId } },\r\n          recipient: { connect: { id: recipientId } },\r\n          ciphertext,\r\n          nonce,\r\n          senderPublicKey,\r\n          timestamp: new Date(),\r\n          metadata: metadata || null,\r\n          read: false\r\n        }\r\n      });\r\n\r\n      return res.status(201).json({\r\n        id: message.id,\r\n        senderId: userId,\r\n        recipientId,\r\n        timestamp: message.timestamp,\r\n        message: 'Message sent successfully'\r\n      });\r\n    } catch (error) {\r\n      console.error('Error sending encrypted message:', error);\r\n      return res.status(500).json({\r\n        error: 'Internal Server Error',\r\n        message: 'Failed to send encrypted message'\r\n      });\r\n    }\r\n  } else if (req.method === 'GET') {\r\n    try {\r\n      // Get query parameters with defaults\r\n      const limit = parseInt(req.query.limit as string) || 20;\r\n      const offset = parseInt(req.query.offset as string) || 0;\r\n      const partnerId = req.query.partnerId as string | undefined;\r\n\r\n      // Build where conditions\r\n      const whereCondition: any = {\r\n        OR: [\r\n          { senderId: userId },\r\n          { recipientId: userId }\r\n        ]\r\n      };\r\n\r\n      // If partnerId is provided, filter messages to/from that user\r\n      if (partnerId) {\r\n        whereCondition.OR = [\r\n          { \r\n            senderId: userId,\r\n            recipientId: partnerId\r\n          },\r\n          {\r\n            senderId: partnerId,\r\n            recipientId: userId\r\n          }\r\n        ];\r\n      }\r\n\r\n      // Get messages\r\n      const messages = await prisma.encryptedMessage.findMany({\r\n        where: whereCondition,\r\n        include: {\r\n          sender: {\r\n            select: {\r\n              id: true,\r\n              name: true,\r\n              image: true\r\n            }\r\n          },\r\n          recipient: {\r\n            select: {\r\n              id: true,\r\n              name: true,\r\n              image: true\r\n            }\r\n          }\r\n        },\r\n        orderBy: {\r\n          timestamp: 'desc'\r\n        },\r\n        take: limit,\r\n        skip: offset\r\n      });\r\n\r\n      // Get total count for pagination\r\n      const totalCount = await prisma.encryptedMessage.count({\r\n        where: whereCondition\r\n      });\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        data: {\r\n          messages,\r\n          pagination: {\r\n            total: totalCount,\r\n            limit,\r\n            offset,\r\n            hasMore: offset + messages.length < totalCount\r\n          }\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error('Error getting encrypted messages:', error);\r\n      return res.status(500).json({\r\n        error: 'Internal Server Error',\r\n        message: 'Failed to get encrypted messages'\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nexport default createApiHandler({\r\n  methods: ['GET', 'POST'],\r\n  requireAuth: true\r\n}, handler); ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\moods\\user.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\profile\\encrypted-preferences.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\profile\\preferences.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'NextApiRequest' is defined but never used.",
        "line": 1,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 1,
        "endColumn": 24
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'NextApiResponse' is defined but never used.",
        "line": 1,
        "column": 26,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 1,
        "endColumn": 41
      }
    ],
    "suppressedMessages": [],
    "errorCount": 2,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { NextApiRequest, NextApiResponse } from 'next';\r\nimport { createApiHandler, ApiError } from '@/lib/api/handlers';\r\nimport { db } from '@/lib/db/prisma';\r\nimport { z } from 'zod';\r\n\r\n/**\r\n * @swagger\r\n * /api/profile/preferences:\r\n *   get:\r\n *     tags: [Preferences]\r\n *     summary: Get user preferences\r\n *     description: Retrieves the current user's preferences\r\n *     security:\r\n *       - cookieAuth: []\r\n *     responses:\r\n *       200:\r\n *         description: User preferences\r\n *         content:\r\n *           application/json:\r\n *             schema:\r\n *               type: object\r\n *               properties:\r\n *                 theme:\r\n *                   type: string\r\n *                   enum: [light, dark, system]\r\n *                   example: system\r\n *                 emailNotifications:\r\n *                   type: boolean\r\n *                   example: true\r\n *                 pushNotifications:\r\n *                   type: boolean\r\n *                   example: true\r\n *                 weeklyDigest:\r\n *                   type: boolean\r\n *                   example: true\r\n *                 language:\r\n *                   type: string\r\n *                   example: en\r\n *                 timezone:\r\n *                   type: string\r\n *                   example: UTC\r\n *       401:\r\n *         description: Unauthorized - User is not authenticated\r\n *       404:\r\n *         description: User not found\r\n *       500:\r\n *         description: Server error\r\n *   put:\r\n *     tags: [Preferences]\r\n *     summary: Replace all user preferences\r\n *     description: Replaces all existing user preferences with new values\r\n *     security:\r\n *       - cookieAuth: []\r\n *     requestBody:\r\n *       required: true\r\n *       content:\r\n *         application/json:\r\n *           schema:\r\n *             type: object\r\n *             properties:\r\n *               theme:\r\n *                 type: string\r\n *                 enum: [light, dark, system]\r\n *               emailNotifications:\r\n *                 type: boolean\r\n *               pushNotifications:\r\n *                 type: boolean\r\n *               weeklyDigest:\r\n *                 type: boolean\r\n *               language:\r\n *                 type: string\r\n *                 minLength: 2\r\n *                 maxLength: 5\r\n *               timezone:\r\n *                 type: string\r\n *     responses:\r\n *       200:\r\n *         description: Preferences updated successfully\r\n *         content:\r\n *           application/json:\r\n *             schema:\r\n *               type: object\r\n *               properties:\r\n *                 message:\r\n *                   type: string\r\n *                   example: Preferences updated successfully\r\n *                 preferences:\r\n *                   $ref: '#/components/schemas/Preferences'\r\n *       400:\r\n *         description: Invalid input\r\n *       401:\r\n *         description: Unauthorized\r\n *       404:\r\n *         description: User not found\r\n *       500:\r\n *         description: Server error\r\n *   patch:\r\n *     tags: [Preferences]\r\n *     summary: Update specific user preferences\r\n *     description: Updates only the specified user preferences, leaving others unchanged\r\n *     security:\r\n *       - cookieAuth: []\r\n *     requestBody:\r\n *       required: true\r\n *       content:\r\n *         application/json:\r\n *           schema:\r\n *             type: object\r\n *             properties:\r\n *               theme:\r\n *                 type: string\r\n *                 enum: [light, dark, system]\r\n *               emailNotifications:\r\n *                 type: boolean\r\n *               pushNotifications:\r\n *                 type: boolean\r\n *               weeklyDigest:\r\n *                 type: boolean\r\n *               language:\r\n *                 type: string\r\n *                 minLength: 2\r\n *                 maxLength: 5\r\n *               timezone:\r\n *                 type: string\r\n *     responses:\r\n *       200:\r\n *         description: Preferences updated successfully\r\n *         content:\r\n *           application/json:\r\n *             schema:\r\n *               type: object\r\n *               properties:\r\n *                 message:\r\n *                   type: string\r\n *                   example: Preferences updated successfully\r\n *                 preferences:\r\n *                   $ref: '#/components/schemas/Preferences'\r\n *       400:\r\n *         description: Invalid input\r\n *       401:\r\n *         description: Unauthorized\r\n *       404:\r\n *         description: User not found\r\n *       500:\r\n *         description: Server error\r\n */\r\n\r\n/**\r\n * @swagger\r\n * components:\r\n *   schemas:\r\n *     Preferences:\r\n *       type: object\r\n *       properties:\r\n *         theme:\r\n *           type: string\r\n *           enum: [light, dark, system]\r\n *           example: system\r\n *         emailNotifications:\r\n *           type: boolean\r\n *           example: true\r\n *         pushNotifications:\r\n *           type: boolean\r\n *           example: true\r\n *         weeklyDigest:\r\n *           type: boolean\r\n *           example: true\r\n *         language:\r\n *           type: string\r\n *           example: en\r\n *         timezone:\r\n *           type: string\r\n *           example: UTC\r\n */\r\n\r\n// Validation schema for user preferences - matches client-side interface\r\nconst preferencesSchema = z.object({\r\n  theme: z.enum(['light', 'dark', 'system']).optional(),\r\n  emailNotifications: z.boolean().optional(),\r\n  pushNotifications: z.boolean().optional(),\r\n  weeklyDigest: z.boolean().optional(),\r\n  language: z.string().min(2).max(5).optional(),\r\n  timezone: z.string().optional(),\r\n});\r\n\r\ntype Preferences = z.infer<typeof preferencesSchema>;\r\n\r\n// Default preferences when none exist\r\nconst defaultPreferences: Preferences = {\r\n  theme: 'system',\r\n  emailNotifications: true,\r\n  pushNotifications: true,\r\n  weeklyDigest: true,\r\n  language: 'en',\r\n  timezone: 'UTC',\r\n};\r\n\r\n/**\r\n * Safely parse JSON string to Preferences object\r\n * @param jsonString - JSON string to parse\r\n * @returns Parsed preferences or default preferences\r\n */\r\nfunction parsePreferences(jsonString: string | null | undefined): Preferences {\r\n  if (!jsonString) {\r\n    return { ...defaultPreferences };\r\n  }\r\n  \r\n  try {\r\n    const parsed = JSON.parse(jsonString);\r\n    // Validate the parsed data against our schema\r\n    return preferencesSchema.parse(parsed);\r\n  } catch (error) {\r\n    // If JSON parsing fails or schema validation fails, return defaults\r\n    console.error('Error parsing preferences:', error);\r\n    return { ...defaultPreferences };\r\n  }\r\n}\r\n\r\nexport default createApiHandler(\r\n  {\r\n    methods: ['GET', 'PUT', 'PATCH'],\r\n    requireAuth: true,\r\n    rateLimitType: 'general',\r\n  },\r\n  async (req, res, { userId }) => {\r\n    try {\r\n      // Ensure userId is a string - ApiHandler should guarantee this when requireAuth is true\r\n      if (!userId) {\r\n        throw ApiError.unauthorized('User ID is required');\r\n      }\r\n\r\n      // GET: Retrieve user preferences\r\n      if (req.method === 'GET') {\r\n        const user = await db.user.findUnique({\r\n          where: { id: userId },\r\n          select: { \r\n            settings: true,\r\n          },\r\n        });\r\n        \r\n        if (!user) {\r\n          throw ApiError.notFound('User not found');\r\n        }\r\n        \r\n        // Parse stored settings or return defaults\r\n        const preferences = parsePreferences(user.settings);\r\n        \r\n        return res.status(200).json(preferences);\r\n      }\r\n      \r\n      // PUT/PATCH: Update user preferences\r\n      if (req.method === 'PUT' || req.method === 'PATCH') {\r\n        try {\r\n          // Validate incoming data\r\n          const validatedData = preferencesSchema.parse(req.body);\r\n          \r\n          // Check if there's anything to update\r\n          if (Object.keys(validatedData).length === 0) {\r\n            return res.status(400).json({ \r\n              message: 'No valid preferences provided to update' \r\n            });\r\n          }\r\n          \r\n          // Get current settings\r\n          const user = await db.user.findUnique({\r\n            where: { id: userId },\r\n            select: { settings: true },\r\n          });\r\n          \r\n          if (!user) {\r\n            throw ApiError.notFound('User not found');\r\n          }\r\n          \r\n          // Get current settings or defaults\r\n          const currentSettings = parsePreferences(user.settings);\r\n              \r\n          // Determine updated settings based on request method\r\n          const updatedSettings = req.method === 'PUT' \r\n            ? { ...validatedData } // Replace all settings (PUT)\r\n            : { ...currentSettings, ...validatedData }; // Merge with existing (PATCH)\r\n          \r\n          // Save to database\r\n          await db.user.update({\r\n            where: { id: userId },\r\n            data: {\r\n              settings: JSON.stringify(updatedSettings),\r\n            },\r\n          });\r\n          \r\n          return res.status(200).json({\r\n            message: 'Preferences updated successfully',\r\n            preferences: updatedSettings,\r\n          });\r\n        } catch (error) {\r\n          if (error instanceof z.ZodError) {\r\n            throw ApiError.badRequest(`Invalid preferences data: ${error.message}`);\r\n          }\r\n          throw error; // Re-throw other errors\r\n        }\r\n      }\r\n      \r\n      // This should never happen due to method validation in createApiHandler\r\n      throw ApiError.methodNotAllowed();\r\n      \r\n    } catch (error) {\r\n      // Handle all other errors not caught in nested try-catch blocks\r\n      if (error instanceof z.ZodError) {\r\n        throw ApiError.badRequest(`Invalid preferences data: ${error.message}`);\r\n      }\r\n      if (error instanceof ApiError) {\r\n        throw error; // Re-throw ApiError instances as-is\r\n      }\r\n      // Convert unknown errors to server errors\r\n      console.error('Unhandled error in preferences API:', error);\r\n      throw ApiError.serverError('An unexpected error occurred');\r\n    }\r\n  }\r\n); ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\profile\\setup-encryption.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\profile\\update.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\streaming\\notifications.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'NextApiRequest' is defined but never used.",
        "line": 1,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 1,
        "endColumn": 24
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'NextApiResponse' is defined but never used.",
        "line": 1,
        "column": 26,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 1,
        "endColumn": 41
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'db' is defined but never used.",
        "line": 4,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 4,
        "endColumn": 12
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'Notification' is defined but never used.",
        "line": 7,
        "column": 11,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 7,
        "endColumn": 23
      },
      {
        "ruleId": "prefer-const",
        "severity": 2,
        "message": "'activeStreams' is never reassigned. Use 'const' instead.",
        "line": 18,
        "column": 5,
        "nodeType": "Identifier",
        "messageId": "useConst",
        "endLine": 18,
        "endColumn": 57,
        "fix": {
          "range": [505, 574],
          "text": "const activeStreams: Map<string, Set<(data: any) => void>> = new Map();"
        }
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 18,
        "column": 43,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 18,
        "endColumn": 46,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [547, 550], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [547, 550], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 23,
        "column": 50,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 23,
        "endColumn": 53,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [692, 695], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [692, 695], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 70,
        "column": 35,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 70,
        "endColumn": 38,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1886, 1889], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1886, 1889], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 8,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 1,
    "fixableWarningCount": 0,
    "source": "import { NextApiRequest, NextApiResponse } from 'next';\r\nimport { createApiHandler } from '@/lib/api/handlers';\r\nimport { createStreamingResponse } from '@/lib/api/streaming';\r\nimport { db } from '@/lib/db/prisma';\r\n\r\n// Mock notification type since we don't have the model\r\ninterface Notification {\r\n  id: string;\r\n  userId: string;\r\n  type: string;\r\n  message: string;\r\n  read: boolean;\r\n  createdAt: Date;\r\n  data: string | null;\r\n}\r\n\r\n// In-memory notifier map to manage active streaming connections\r\nlet activeStreams: Map<string, Set<(data: any) => void>> = new Map();\r\n\r\n/**\r\n * Send notification to all active streams for a user\r\n */\r\nexport function notifyUser(userId: string, data: any) {\r\n  const listeners = activeStreams.get(userId);\r\n  \r\n  if (listeners && listeners.size > 0) {\r\n    listeners.forEach(callback => {\r\n      try {\r\n        callback(data);\r\n      } catch (error) {\r\n        console.error('Error sending notification:', error);\r\n      }\r\n    });\r\n    return true;\r\n  }\r\n  \r\n  return false;\r\n}\r\n\r\nexport default createApiHandler(\r\n  {\r\n    methods: ['GET'],\r\n    requireAuth: true,\r\n    rateLimitType: 'general',\r\n  },\r\n  async (req, res, { userId }) => {\r\n    if (!userId) {\r\n      return res.status(401).json({ message: 'Unauthorized' });\r\n    }\r\n    \r\n    // Create streaming response\r\n    const stream = createStreamingResponse(req, res, {\r\n      keepAlive: true,\r\n      heartbeatInterval: 30000, // 30 seconds\r\n    });\r\n    \r\n    // Send initial connection notification\r\n    stream.send({ \r\n      type: 'connected', \r\n      message: 'Connected to notification stream', \r\n      timestamp: new Date().toISOString()\r\n    });\r\n    \r\n    // Register this stream for the user\r\n    if (!activeStreams.has(userId)) {\r\n      activeStreams.set(userId, new Set());\r\n    }\r\n    \r\n    // Create callback function for this connection\r\n    const streamCallback = (data: any) => {\r\n      stream.send(data);\r\n    };\r\n    \r\n    // Add callback to the set of listeners for this user\r\n    activeStreams.get(userId)?.add(streamCallback);\r\n    \r\n    // Handle client disconnection\r\n    req.on('close', () => {\r\n      const listeners = activeStreams.get(userId);\r\n      \r\n      if (listeners) {\r\n        listeners.delete(streamCallback);\r\n        \r\n        // Clean up user entry if no listeners remain\r\n        if (listeners.size === 0) {\r\n          activeStreams.delete(userId);\r\n        }\r\n      }\r\n    });\r\n    \r\n    // Send a test notification after 5 seconds\r\n    setTimeout(() => {\r\n      if (!stream.isClosed()) {\r\n        stream.send({ \r\n          type: 'notification', \r\n          message: 'This is a test notification', \r\n          timestamp: new Date().toISOString() \r\n        });\r\n      }\r\n    }, 5000);\r\n  }\r\n);\r\n\r\n// Helper to generate a notification for a user - commented out as we don't have the model\r\n/*\r\nexport async function createNotification(\r\n  userId: string,\r\n  type: string,\r\n  message: string,\r\n  data?: any\r\n) {\r\n  try {\r\n    // Store notification in database - assuming we have a notifications table\r\n    // You'll need to add this model to your Prisma schema\r\n    \r\n    const notification: Notification = {\r\n      id: `notification-${Date.now()}`,\r\n      userId,\r\n      type,\r\n      message,\r\n      data: data ? JSON.stringify(data) : null,\r\n      read: false,\r\n      createdAt: new Date()\r\n    };\r\n    \r\n    // Send real-time notification\r\n    notifyUser(userId, {\r\n      type: 'notification',\r\n      notificationId: notification.id,\r\n      message,\r\n      notificationType: type,\r\n      timestamp: notification.createdAt.toISOString(),\r\n      data,\r\n    });\r\n    \r\n    return notification;\r\n  } catch (error) {\r\n    console.error('Error creating notification:', error);\r\n    throw error;\r\n  }\r\n}\r\n*/ ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\test-db.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\test\\notification.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\upload\\profile-image.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\api\\users\\[id]\\public-key.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'context' is defined but never used.",
        "line": 51,
        "column": 67,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 51,
        "endColumn": 74
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { NextApiRequest, NextApiResponse } from 'next';\r\nimport { createApiHandler } from '@/lib/api/handlers';\r\nimport { prisma } from '@/lib/prisma';\r\nimport { Session } from 'next-auth';\r\n\r\n// Define interface to match ApiContext\r\ninterface ApiContext {\r\n  session: Session | null;\r\n  userId: string | null;\r\n}\r\n\r\n/**\r\n * @swagger\r\n * /api/users/{id}/public-key:\r\n *   get:\r\n *     summary: Get user's public key\r\n *     description: Retrieves the public key for a specific user\r\n *     tags:\r\n *       - Users\r\n *     parameters:\r\n *       - in: path\r\n *         name: id\r\n *         required: true\r\n *         schema:\r\n *           type: string\r\n *         description: The user ID\r\n *     responses:\r\n *       200:\r\n *         description: Public key retrieved successfully\r\n *         content:\r\n *           application/json:\r\n *             schema:\r\n *               type: object\r\n *               properties:\r\n *                 publicKey:\r\n *                   type: string\r\n *                   description: The user's public key\r\n *                 userId:\r\n *                   type: string\r\n *                   description: The user ID\r\n *                 createdAt:\r\n *                   type: string\r\n *                   format: date-time\r\n *                   description: When the key was created\r\n *       404:\r\n *         description: User or public key not found\r\n *       500:\r\n *         description: Server error\r\n */\r\n\r\nconst handler = async (req: NextApiRequest, res: NextApiResponse, context: ApiContext) => {  \r\n  // Extract user ID from the URL params\r\n  const { id } = req.query;\r\n\r\n  if (!id || typeof id !== 'string') {\r\n    return res.status(400).json({\r\n      error: 'Bad Request',\r\n      message: 'User ID is required'\r\n    });\r\n  }\r\n\r\n  try {\r\n    // Check if user exists\r\n    const user = await prisma.user.findUnique({\r\n      where: { id }\r\n    });\r\n\r\n    if (!user) {\r\n      return res.status(404).json({\r\n        error: 'Not Found',\r\n        message: 'User not found'\r\n      });\r\n    }\r\n\r\n    // Retrieve the user's public key\r\n    const encryptionKey = await prisma.encryptionKey.findUnique({\r\n      where: { userId: id },\r\n      select: {\r\n        publicKey: true,\r\n        userId: true,\r\n        createdAt: true\r\n      }\r\n    });\r\n\r\n    if (!encryptionKey) {\r\n      return res.status(404).json({\r\n        error: 'Not Found',\r\n        message: 'Public key not found for this user'\r\n      });\r\n    }\r\n    \r\n    return res.status(200).json({\r\n      publicKey: encryptionKey.publicKey,\r\n      userId: encryptionKey.userId,\r\n      createdAt: encryptionKey.createdAt\r\n    });\r\n  } catch (error) {\r\n    console.error('Error fetching user public key:', error);\r\n    return res.status(500).json({\r\n      error: 'Internal Server Error',\r\n      message: 'Failed to fetch user public key'\r\n    });\r\n  }\r\n};\r\n\r\nexport default createApiHandler({\r\n  methods: ['GET'],\r\n  requireAuth: true\r\n}, handler); ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\auth\\error.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\auth\\forgot-password.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\auth\\register.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\auth\\reset-password.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\auth\\signin.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\auth\\verify-request.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\auth\\verify.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\dashboard\\index.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 21,
        "column": 18,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 21,
        "endColumn": 21,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [926, 929], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [926, 929], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'session' is assigned a value but never used.",
        "line": 27,
        "column": 17,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 27,
        "endColumn": 24
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 38,
        "column": 54,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 38,
        "endColumn": 57,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1422, 1425], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1422, 1425], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'streamData' is assigned a value but never used.",
        "line": 53,
        "column": 11,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 53,
        "endColumn": 21
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'streamError' is assigned a value but never used.",
        "line": 54,
        "column": 12,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 54,
        "endColumn": 23
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'error' is defined but never used.",
        "line": 111,
        "column": 14,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 111,
        "endColumn": 19
      }
    ],
    "suppressedMessages": [],
    "errorCount": 6,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { useState, useEffect, useCallback } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\nimport { useRouter } from 'next/router';\r\nimport { MainLayout } from '@/components/layout/main-layout';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card/card';\r\nimport { Button } from '@/components/ui/button/button';\r\nimport { PageMeta } from '@/components/SEO/PageMeta';\r\nimport { generateBreadcrumbSchema } from '@/lib/seo/schema';\r\nimport { usePreferences } from '@/lib/hooks/usePreferences';\r\nimport { useStreamingData } from '@/lib/api/streaming';\r\nimport { api } from '@/lib/api/client';\r\nimport { useFetch } from '@/lib/hooks/useFetch';\r\nimport { toast } from 'sonner';\r\nimport { Loader2, RefreshCw, AlertCircle } from 'lucide-react';\r\n\r\n// Define the notification type\r\ninterface StreamingNotification {\r\n  type: string;\r\n  message: string;\r\n  timestamp: string;\r\n  [key: string]: any; // Allow other properties\r\n}\r\n\r\n// Dashboard component using our custom implementations\r\nexport default function Dashboard() {\r\n  const router = useRouter();\r\n  const { data: session, status } = useSession();\r\n  const { \r\n    preferences, \r\n    updatePreferences, \r\n    isLoading: prefsLoading, \r\n    isSaving: prefsSaving,\r\n    error: prefsError,\r\n    refetch: refetchPreferences \r\n  } = usePreferences();\r\n  \r\n  // Notifications state\r\n  const [notifications, setNotifications] = useState<any[]>([]);\r\n  \r\n  // Use our custom fetch hook for data\r\n  const { \r\n    data: dashboardData, \r\n    error: dashboardError, \r\n    isValidating,\r\n    mutate: refreshDashboardData \r\n  } = useFetch(\r\n    '/api/dashboard/stats',\r\n    { revalidateOnFocus: true }\r\n  );\r\n  \r\n  // Use our custom streaming implementation for real-time updates\r\n  const { \r\n    data: streamData, \r\n    error: streamError, \r\n    isConnected: streamConnected \r\n  } = useStreamingData<StreamingNotification>('/api/streaming/notifications', {\r\n    onMessage: (data) => {\r\n      if (data.type === 'notification') {\r\n        setNotifications((prev) => [data, ...prev].slice(0, 10));\r\n        \r\n        // Show toast for new notifications when they arrive\r\n        toast.info('New notification', {\r\n          description: data.message,\r\n          duration: 4000,\r\n        });\r\n      }\r\n    }\r\n  });\r\n  \r\n  // Check auth status\r\n  useEffect(() => {\r\n    if (status === 'unauthenticated') {\r\n      router.push('/auth/signin?callbackUrl=/dashboard');\r\n    }\r\n  }, [status, router]);\r\n\r\n  // Show error toast if preferences failed to load\r\n  useEffect(() => {\r\n    if (prefsError) {\r\n      toast.error('Failed to load preferences', {\r\n        description: 'Default settings will be used. You can try refreshing the page.',\r\n        duration: 5000,\r\n      });\r\n    }\r\n  }, [prefsError]);\r\n  \r\n  // Toggle theme preference handler with optimistic update\r\n  const toggleTheme = useCallback(async () => {\r\n    if (prefsLoading || prefsSaving) return;\r\n    \r\n    const newTheme = preferences.theme === 'dark' ? 'light' : 'dark';\r\n    \r\n    try {\r\n      await updatePreferences({ theme: newTheme });\r\n    } catch (error) {\r\n      // Error is handled in the hook with toast notifications\r\n      console.error('Failed to update theme preference:', error);\r\n    }\r\n  }, [preferences.theme, updatePreferences, prefsLoading, prefsSaving]);\r\n  \r\n  // Refresh all dashboard data\r\n  const refreshAllData = useCallback(async () => {\r\n    toast.info('Refreshing dashboard data...');\r\n    \r\n    try {\r\n      await Promise.all([\r\n        refetchPreferences(),\r\n        refreshDashboardData()\r\n      ]);\r\n      toast.success('Dashboard data refreshed');\r\n    } catch (error) {\r\n      toast.error('Failed to refresh some data');\r\n    }\r\n  }, [refetchPreferences, refreshDashboardData]);\r\n  \r\n  // Mock triggering a notification\r\n  const triggerNotification = useCallback(async () => {\r\n    try {\r\n      const toastId = toast.loading('Sending test notification...');\r\n      await api.post('/api/test/notification', {\r\n        message: `Test notification at ${new Date().toLocaleTimeString()}`,\r\n      });\r\n      toast.success('Test notification sent', { id: toastId });\r\n    } catch (error) {\r\n      toast.error('Failed to send test notification', {\r\n        description: 'Please try again later.'\r\n      });\r\n      console.error('Failed to trigger notification:', error);\r\n    }\r\n  }, []);\r\n  \r\n  // Handle loading state\r\n  if (status === 'loading') {\r\n    return (\r\n      <MainLayout>\r\n        <div className=\"flex items-center justify-center min-h-[60vh]\">\r\n          <div className=\"flex flex-col items-center gap-4\">\r\n            <Loader2 className=\"h-12 w-12 animate-spin text-primary\" />\r\n            <p className=\"text-muted-foreground\">Loading your dashboard...</p>\r\n          </div>\r\n        </div>\r\n      </MainLayout>\r\n    );\r\n  }\r\n  \r\n  // Show login message if not authenticated\r\n  if (status === 'unauthenticated') {\r\n    return null; // Redirect handled by useEffect\r\n  }\r\n  \r\n  return (\r\n    <>\r\n      <PageMeta \r\n        title=\"Dashboard\" \r\n        description=\"Your personal MoodMash dashboard\" \r\n        structuredData={generateBreadcrumbSchema([\r\n          { name: 'Home', url: '/' },\r\n          { name: 'Dashboard', url: '/dashboard' },\r\n        ])}\r\n      />\r\n      \r\n      <MainLayout>\r\n        <div className=\"container py-8\">\r\n          <div className=\"flex justify-between items-center mb-6\">\r\n            <h1 className=\"text-3xl font-bold\">Dashboard</h1>\r\n            \r\n            <Button \r\n              variant=\"outline\" \r\n              onClick={refreshAllData}\r\n              disabled={isValidating || prefsLoading}\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              {(isValidating || prefsLoading) ? (\r\n                <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n              ) : (\r\n                <RefreshCw className=\"h-4 w-4\" />\r\n              )}\r\n              Refresh\r\n            </Button>\r\n          </div>\r\n          \r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            {/* User Stats Card */}\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-lg flex items-center justify-between\">\r\n                  <span>Your Stats</span>\r\n                  {dashboardError && (\r\n                    <span className=\"text-red-500 flex items-center\">\r\n                      <AlertCircle className=\"h-4 w-4\" aria-label=\"Error loading stats\" />\r\n                    </span>\r\n                  )}\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                {dashboardError ? (\r\n                  <div className=\"text-red-500 flex flex-col gap-2\">\r\n                    <p>Failed to load stats</p>\r\n                    <Button \r\n                      size=\"sm\" \r\n                      variant=\"outline\" \r\n                      onClick={() => refreshDashboardData()}\r\n                      className=\"w-full\"\r\n                    >\r\n                      Try Again\r\n                    </Button>\r\n                  </div>\r\n                ) : isValidating ? (\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-3/4\"></div>\r\n                    <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-1/2\"></div>\r\n                    <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-5/6\"></div>\r\n                  </div>\r\n                ) : dashboardData ? (\r\n                  <div className=\"space-y-2\">\r\n                    <p>Moods shared: {dashboardData.moodCount || 0}</p>\r\n                    <p>Likes received: {dashboardData.likesReceived || 0}</p>\r\n                    <p>Comments received: {dashboardData.commentsReceived || 0}</p>\r\n                  </div>\r\n                ) : (\r\n                  <p>No stats available</p>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n            \r\n            {/* Theme Preference Card */}\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-lg flex items-center justify-between\">\r\n                  <span>Preferences</span>\r\n                  {prefsError && (\r\n                    <span className=\"text-red-500 flex items-center\">\r\n                      <AlertCircle className=\"h-4 w-4\" aria-label=\"Error loading preferences\" />\r\n                    </span>\r\n                  )}\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                {prefsLoading ? (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-1/2\"></div>\r\n                    <div className=\"h-10 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-full\"></div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span>Current theme:</span>\r\n                      <span className=\"font-medium capitalize\">{preferences.theme || 'system'}</span>\r\n                    </div>\r\n                    \r\n                    <Button \r\n                      onClick={toggleTheme} \r\n                      disabled={prefsLoading || prefsSaving}\r\n                      className=\"w-full\"\r\n                    >\r\n                      {prefsSaving ? (\r\n                        <>\r\n                          <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                          Saving...\r\n                        </>\r\n                      ) : (\r\n                        <>Switch to {preferences.theme === 'dark' ? 'Light' : 'Dark'} Mode</>\r\n                      )}\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n            \r\n            {/* Notifications Card */}\r\n            <Card>\r\n              <CardHeader className=\"pb-2 flex flex-row items-center justify-between\">\r\n                <CardTitle className=\"text-lg\">Notifications</CardTitle>\r\n                <div className={`h-2 w-2 rounded-full ${streamConnected ? 'bg-green-500' : 'bg-red-500'}`} \r\n                  title={streamConnected ? 'Connected' : 'Not connected'}>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <span className=\"text-sm\">\r\n                      {streamConnected ? (\r\n                        <span className=\"text-green-500\">\r\n                          Connected to real-time updates\r\n                        </span>\r\n                      ) : (\r\n                        <span className=\"text-red-500\">\r\n                          Not connected\r\n                        </span>\r\n                      )}\r\n                    </span>\r\n                    \r\n                    <Button \r\n                      size=\"sm\" \r\n                      onClick={triggerNotification}\r\n                      disabled={!streamConnected}\r\n                    >\r\n                      Test\r\n                    </Button>\r\n                  </div>\r\n                  \r\n                  <div className=\"space-y-2 max-h-40 overflow-y-auto p-1\">\r\n                    {notifications.length > 0 ? (\r\n                      notifications.map((notification, i) => (\r\n                        <div key={i} className=\"p-2 bg-gray-100 dark:bg-gray-800 rounded text-sm\">\r\n                          <p>{notification.message}</p>\r\n                          <p className=\"text-xs text-gray-500 mt-1\">\r\n                            {new Date(notification.timestamp).toLocaleTimeString()}\r\n                          </p>\r\n                        </div>\r\n                      ))\r\n                    ) : (\r\n                      <div className=\"text-sm text-gray-500 text-center p-4\">\r\n                        {streamConnected ? 'No notifications yet' : 'Connect to receive notifications'}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </div>\r\n      </MainLayout>\r\n    </>\r\n  );\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\error-test.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\index.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\language-demo.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\profile\\edit.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'RefreshCw' is defined but never used.",
        "line": 16,
        "column": 42,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 16,
        "endColumn": 51
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'updateError' is assigned a value but never used.",
        "line": 45,
        "column": 55,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 45,
        "endColumn": 66
      }
    ],
    "suppressedMessages": [],
    "errorCount": 2,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { useEffect, useState } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\nimport { useRouter } from 'next/router';\r\nimport Head from 'next/head';\r\nimport Image from 'next/image';\r\nimport { MainLayout } from '@/components/layout/main-layout';\r\nimport { Button } from '@/components/ui/button/button';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardFooter,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card/card';\r\nimport { User, Upload, Loader2, Save, X, RefreshCw } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { useMutation } from '@/lib/hooks/useFetch';\r\n\r\ninterface ExtendedUser {\r\n  id: string;\r\n  name?: string | null;\r\n  email?: string | null;\r\n  image?: string | null;\r\n  bio?: string | null;\r\n}\r\n\r\ninterface ProfileUpdateData {\r\n  name: string;\r\n  bio: string;\r\n  image: string;\r\n}\r\n\r\nexport default function EditProfile() {\r\n  const { data: session, status, update } = useSession();\r\n  const router = useRouter();\r\n  const [name, setName] = useState('');\r\n  const [bio, setBio] = useState('');\r\n  const [image, setImage] = useState('');\r\n  const [imageFile, setImageFile] = useState<File | null>(null);\r\n  const [imagePreview, setImagePreview] = useState('');\r\n  const [isUploading, setIsUploading] = useState(false);\r\n\r\n  // Use the enhanced mutation hook for profile updates\r\n  const [updateProfile, { isLoading: isSaving, error: updateError, reset: resetUpdateError }] = \r\n    useMutation<{ success: boolean, user: ExtendedUser }, ProfileUpdateData>(\r\n      '/api/profile/update',\r\n      'POST',\r\n      {\r\n        showToasts: true,\r\n        messages: {\r\n          loading: 'Saving profile changes...',\r\n          success: 'Profile updated successfully',\r\n          error: 'Failed to update profile'\r\n        },\r\n        // Optimistic update function would go here if needed\r\n        // optimisticUpdate: (data) => { ... }\r\n      }\r\n    );\r\n\r\n  useEffect(() => {\r\n    if (status === 'unauthenticated') {\r\n      router.push('/auth/signin?callbackUrl=/profile/edit');\r\n    }\r\n  }, [status, router]);\r\n\r\n  useEffect(() => {\r\n    if (session?.user) {\r\n      const user = session.user as ExtendedUser;\r\n      setName(user.name || '');\r\n      setBio(user.bio || '');\r\n      setImage(user.image || '');\r\n      setImagePreview(user.image || '');\r\n    }\r\n  }, [session]);\r\n\r\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      // Check file size (limit to 5MB)\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        toast.error('Image too large', { \r\n          description: 'Please select an image under 5MB' \r\n        });\r\n        return;\r\n      }\r\n      \r\n      setImageFile(file);\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        const result = reader.result as string;\r\n        setImagePreview(result);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const removeImage = () => {\r\n    setImageFile(null);\r\n    setImagePreview(image); // Reset to original\r\n  };\r\n\r\n  const uploadImage = async () => {\r\n    if (!imageFile) return null;\r\n    \r\n    setIsUploading(true);\r\n    \r\n    try {\r\n      // Create form data for image upload\r\n      const formData = new FormData();\r\n      formData.append('file', imageFile);\r\n\r\n      const toastId = toast.loading('Uploading image...');\r\n      \r\n      const uploadResponse = await fetch('/api/upload/profile-image', {\r\n        method: 'POST',\r\n        body: formData,\r\n      });\r\n\r\n      if (!uploadResponse.ok) {\r\n        throw new Error('Failed to upload image');\r\n      }\r\n\r\n      const uploadData = await uploadResponse.json();\r\n      toast.success('Image uploaded', { id: toastId });\r\n      \r\n      return uploadData.url;\r\n    } catch (error) {\r\n      console.error('Error uploading image:', error);\r\n      toast.error('Failed to upload image');\r\n      return null;\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    \r\n    try {\r\n      // First upload image if needed\r\n      let imageUrl = image;\r\n      if (imageFile) {\r\n        const uploadedUrl = await uploadImage();\r\n        if (!uploadedUrl) return; // Stop if upload failed\r\n        imageUrl = uploadedUrl;\r\n      }\r\n\r\n      // Update profile with the new mutation hook\r\n      const result = await updateProfile({\r\n        name,\r\n        bio,\r\n        image: imageUrl,\r\n      });\r\n\r\n      // Update the session with new user data\r\n      if (result.success) {\r\n        await update({\r\n          ...session,\r\n          user: {\r\n            ...session?.user,\r\n            name,\r\n            bio,\r\n            image: imageUrl,\r\n          },\r\n        });\r\n        \r\n        // Navigate back to profile page\r\n        router.push('/profile');\r\n      }\r\n    } catch (error) {\r\n      // Error handling is done by the mutation hook\r\n      console.error('Error in profile update flow:', error);\r\n    }\r\n  };\r\n  \r\n  // Reset error when leaving page\r\n  useEffect(() => {\r\n    return () => resetUpdateError();\r\n  }, [resetUpdateError]);\r\n\r\n  if (status === 'loading' || status === 'unauthenticated') {\r\n    return (\r\n      <MainLayout>\r\n        <div className=\"flex justify-center items-center py-10\">\r\n          <div className=\"flex flex-col items-center gap-4\">\r\n            <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n            <p className=\"text-muted-foreground\">Loading profile data...</p>\r\n          </div>\r\n        </div>\r\n      </MainLayout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Head>\r\n        <title>Edit Profile - MoodMash</title>\r\n        <meta name=\"description\" content=\"Edit your profile information\" />\r\n      </Head>\r\n      <MainLayout>\r\n        <div className=\"container max-w-2xl py-10\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Edit Profile</CardTitle>\r\n              <CardDescription>Update your profile information</CardDescription>\r\n            </CardHeader>\r\n            <form onSubmit={handleSubmit}>\r\n              <CardContent className=\"space-y-6\">\r\n                {/* Profile Image */}\r\n                <div className=\"flex flex-col items-center space-y-4\">\r\n                  <div className=\"relative w-32 h-32 rounded-full overflow-hidden border-2 border-primary\">\r\n                    {imagePreview ? (\r\n                      <Image\r\n                        src={imagePreview}\r\n                        alt=\"Profile preview\"\r\n                        fill\r\n                        className=\"object-cover\"\r\n                      />\r\n                    ) : (\r\n                      <div className=\"w-full h-full bg-muted flex items-center justify-center\">\r\n                        <User className=\"h-16 w-16 text-muted-foreground\" />\r\n                      </div>\r\n                    )}\r\n                    {isUploading && (\r\n                      <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\">\r\n                        <Loader2 className=\"h-8 w-8 animate-spin text-white\" />\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Button type=\"button\" variant=\"outline\" size=\"sm\" className=\"relative\" disabled={isUploading}>\r\n                      <input\r\n                        type=\"file\"\r\n                        accept=\"image/*\"\r\n                        onChange={handleImageChange}\r\n                        className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\r\n                        disabled={isUploading}\r\n                      />\r\n                      <Upload className=\"h-4 w-4 mr-2\" />\r\n                      Upload Image\r\n                    </Button>\r\n                    {imagePreview && imagePreview !== image && (\r\n                      <Button \r\n                        type=\"button\" \r\n                        variant=\"ghost\" \r\n                        size=\"sm\" \r\n                        onClick={removeImage}\r\n                        disabled={isUploading}\r\n                      >\r\n                        <X className=\"h-4 w-4 mr-2\" />\r\n                        Remove\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                  <p className=\"text-xs text-muted-foreground\">Maximum size: 5MB</p>\r\n                </div>\r\n\r\n                {/* Name */}\r\n                <div className=\"space-y-2\">\r\n                  <label htmlFor=\"name\" className=\"text-sm font-medium\">\r\n                    Display Name\r\n                  </label>\r\n                  <input\r\n                    id=\"name\"\r\n                    className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-primary\"\r\n                    value={name}\r\n                    onChange={e => setName(e.target.value)}\r\n                    placeholder=\"Your display name\"\r\n                    disabled={isSaving || isUploading}\r\n                  />\r\n                </div>\r\n\r\n                {/* Bio */}\r\n                <div className=\"space-y-2\">\r\n                  <label htmlFor=\"bio\" className=\"text-sm font-medium\">\r\n                    Bio\r\n                  </label>\r\n                  <textarea\r\n                    id=\"bio\"\r\n                    className=\"flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-primary\"\r\n                    value={bio}\r\n                    onChange={e => setBio(e.target.value)}\r\n                    placeholder=\"Tell us about yourself\"\r\n                    rows={4}\r\n                    maxLength={160}\r\n                    disabled={isSaving || isUploading}\r\n                  />\r\n                  <p className=\"text-xs text-muted-foreground\">{bio.length}/160 characters</p>\r\n                </div>\r\n              </CardContent>\r\n\r\n              <CardFooter className=\"flex justify-between\">\r\n                <Button \r\n                  type=\"button\" \r\n                  variant=\"outline\" \r\n                  onClick={() => router.push('/profile')}\r\n                  disabled={isSaving || isUploading}\r\n                >\r\n                  Cancel\r\n                </Button>\r\n                <Button \r\n                  type=\"submit\" \r\n                  disabled={isSaving || isUploading}\r\n                >\r\n                  {isSaving ? (\r\n                    <>\r\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                      Saving...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Save className=\"mr-2 h-4 w-4\" />\r\n                      Save Changes\r\n                    </>\r\n                  )}\r\n                </Button>\r\n              </CardFooter>\r\n            </form>\r\n          </Card>\r\n        </div>\r\n      </MainLayout>\r\n    </>\r\n  );\r\n}\r\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\pages\\profile\\index.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\stories\\Button.stories.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\stories\\Button.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\stories\\Header.stories.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\stories\\Header.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\stories\\Page.stories.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\stories\\Page.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\types\\prisma.d.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'User' is defined but never used.",
        "line": 4,
        "column": 3,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 4,
        "endColumn": 7
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 14,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 14,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [303, 306], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [303, 306], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 15,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 15,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [325, 328], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [325, 328], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 21,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 21,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [418, 421], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [418, 421], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 22,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 22,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [440, 443], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [440, 443], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 34,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 34,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [645, 648], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [645, 648], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 35,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 35,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [667, 670], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [667, 670], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 44,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 44,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [845, 848], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [845, 848], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 45,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 45,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [867, 870], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [867, 870], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 55,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 55,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1077, 1080], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1077, 1080], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 56,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 56,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1099, 1102], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1099, 1102], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 68,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 68,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1304, 1307], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1304, 1307], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 69,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 69,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1326, 1329], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1326, 1329], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 78,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 78,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1506, 1509], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1506, 1509], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 79,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 79,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1528, 1531], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1528, 1531], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 113,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 113,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2228, 2231], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2228, 2231], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 135,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 135,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2717, 2720], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2717, 2720], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 136,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 136,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2739, 2742], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2739, 2742], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 154,
        "column": 58,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 154,
        "endColumn": 61,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3495, 3498], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3495, 3498], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 19,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { \r\n  PrismaClient as OriginalPrismaClient, \r\n  Prisma as PrismaNamespace,\r\n  User\r\n} from '@prisma/client';\r\n\r\n// Define the shape of the Encryption Key model\r\ninterface EncryptionKeyModel {\r\n  findUnique: (args: {\r\n    where: {\r\n      id?: string;\r\n      userId?: string;\r\n    };\r\n    select?: any;\r\n  }) => Promise<any>;\r\n  \r\n  findFirst: (args: {\r\n    where: {\r\n      userId?: string;\r\n    };\r\n    select?: any;\r\n  }) => Promise<any>;\r\n  \r\n  update: (args: {\r\n    where: {\r\n      id?: string;\r\n      userId?: string;\r\n    };\r\n    data: {\r\n      publicKey?: string;\r\n      salt?: string;\r\n      updatedAt?: Date;\r\n    };\r\n    select?: any;\r\n  }) => Promise<any>;\r\n  \r\n  create: (args: {\r\n    data: {\r\n      userId: string;\r\n      publicKey: string;\r\n      salt: string;\r\n      user?: { connect: { id: string } };\r\n    };\r\n    select?: any;\r\n  }) => Promise<any>;\r\n}\r\n\r\n// Define the shape of the Encrypted Preferences model\r\ninterface EncryptedPreferencesModel {\r\n  findUnique: (args: {\r\n    where: {\r\n      id?: string;\r\n      userId?: string;\r\n    };\r\n    select?: any;\r\n  }) => Promise<any>;\r\n  \r\n  update: (args: {\r\n    where: {\r\n      id?: string;\r\n      userId?: string;\r\n    };\r\n    data: {\r\n      ciphertext: string;\r\n      nonce: string;\r\n      updatedAt?: Date;\r\n    };\r\n    select?: any;\r\n  }) => Promise<any>;\r\n  \r\n  create: (args: {\r\n    data: {\r\n      userId: string;\r\n      ciphertext: string;\r\n      nonce: string;\r\n      user?: { connect: { id: string } };\r\n    };\r\n    select?: any;\r\n  }) => Promise<any>;\r\n}\r\n\r\n// Define the shape of the Encrypted Message model\r\ninterface EncryptedMessageModel {\r\n  findMany: (args: {\r\n    where: {\r\n      id?: string;\r\n      senderId?: string;\r\n      recipientId?: string;\r\n      read?: boolean;\r\n    };\r\n    include?: {\r\n      sender?: {\r\n        select?: {\r\n          id?: boolean;\r\n          name?: boolean;\r\n          image?: boolean;\r\n        };\r\n      };\r\n      recipient?: {\r\n        select?: {\r\n          id?: boolean;\r\n          name?: boolean;\r\n          image?: boolean;\r\n        };\r\n      };\r\n    };\r\n    orderBy?: {\r\n      timestamp?: 'asc' | 'desc';\r\n      createdAt?: 'asc' | 'desc';\r\n    };\r\n    take?: number;\r\n    skip?: number;\r\n  }) => Promise<any[]>;\r\n  \r\n  count: (args: {\r\n    where: {\r\n      id?: string;\r\n      senderId?: string;\r\n      recipientId?: string;\r\n      read?: boolean;\r\n    };\r\n  }) => Promise<number>;\r\n  \r\n  create: (args: {\r\n    data: {\r\n      sender: { connect: { id: string } };\r\n      recipient: { connect: { id: string } };\r\n      ciphertext: string;\r\n      nonce: string;\r\n      senderPublicKey: string;\r\n      timestamp?: Date;\r\n      metadata?: string | null;\r\n      read?: boolean;\r\n    };\r\n    select?: any;\r\n  }) => Promise<any>;\r\n}\r\n\r\n// Extend the transaction context for Prisma\r\ninterface ExtendedTransactionClient extends Omit<PrismaNamespace.TransactionClient, keyof PrismaNamespace.TransactionClient> {\r\n  encryptionKey: EncryptionKeyModel;\r\n  encryptedPreferences: EncryptedPreferencesModel;\r\n  encryptedMessage: EncryptedMessageModel;\r\n}\r\n\r\n// Extend the PrismaClient with our custom models\r\ndeclare module '@prisma/client' {\r\n  export interface PrismaClient extends OriginalPrismaClient {\r\n    encryptionKey: EncryptionKeyModel;\r\n    encryptedPreferences: EncryptedPreferencesModel;\r\n    encryptedMessage: EncryptedMessageModel;\r\n    \r\n    // Extend the $transaction method to use our extended transaction client\r\n    $transaction<P extends PrismaNamespace.PrismaPromise<any>[]>(\r\n      arg: [...P],\r\n      options?: { maxWait?: number; timeout?: number; isolationLevel?: PrismaNamespace.TransactionIsolationLevel }\r\n    ): Promise<PrismaNamespace.UnwrapTuple<P>>;\r\n    \r\n    $transaction<R>(\r\n      fn: (prisma: ExtendedTransactionClient) => Promise<R>,\r\n      options?: { maxWait?: number; timeout?: number; isolationLevel?: PrismaNamespace.TransactionIsolationLevel }\r\n    ): Promise<R>;\r\n  }\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\types\\swagger-ui-react.d.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 5,
        "column": 26,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 5,
        "endColumn": 29,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [136, 139], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [136, 139], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 11,
        "column": 32,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 11,
        "endColumn": 35,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [346, 349], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [346, 349], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 11,
        "column": 40,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 11,
        "endColumn": 43,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [354, 357], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [354, 357], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 12,
        "column": 33,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 12,
        "endColumn": 36,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [392, 395], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [392, 395], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 12,
        "column": 41,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 12,
        "endColumn": 44,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [400, 403], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [400, 403], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 13,
        "column": 20,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 13,
        "endColumn": 23,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [425, 428], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [425, 428], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 6,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "declare module 'swagger-ui-react' {\r\n  import { ComponentType } from 'react';\r\n\r\n  interface SwaggerUIProps {\r\n    spec: Record<string, any>;\r\n    url?: string;\r\n    docExpansion?: 'list' | 'full' | 'none';\r\n    defaultModelExpandDepth?: number;\r\n    defaultModelsExpandDepth?: number;\r\n    deepLinking?: boolean;\r\n    requestInterceptor?: (req: any) => any;\r\n    responseInterceptor?: (res: any) => any;\r\n    [key: string]: any;\r\n  }\r\n\r\n  const SwaggerUI: ComponentType<SwaggerUIProps>;\r\n  export default SwaggerUI;\r\n} ",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\utils\\i18n-server.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\abdul\\Desktop\\moodmash\\src\\utils\\text-direction.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  }
]
